<?xml version="1.0" encoding="utf-8"?>
<search> 
  
    
    <entry>
      <title>小程序swiper bindChange重复执行</title>
      <link href="/2018/09/29/%E5%B0%8F%E7%A8%8B%E5%BA%8Fswiper-bindChange%E9%87%8D%E5%A4%8D%E6%89%A7%E8%A1%8C/"/>
      <url>/2018/09/29/%E5%B0%8F%E7%A8%8B%E5%BA%8Fswiper-bindChange%E9%87%8D%E5%A4%8D%E6%89%A7%E8%A1%8C/</url>
      <content type="html"><![CDATA[<blockquote><p>问题：在上一篇文章中写到了自己封装的一个tabBar的组件，以实现能够左右滑动的功能，我使用的是就是小程序里面自带的 swiper 组件来实现。但是经过测试发现了一个问题：当进入页面快速快速的滑动几次就会开始闪烁，页面自己就不停的左右滑动。</p></blockquote><p>进行真机调试的时候， 通过控制台打印可以发现是 <code>bindChange</code> 绑定的方法重复执行了, 这时候我找到了官方文档的解释 <a href="https://developers.weixin.qq.com/miniprogram/dev/component/swiper.html" target="_blank" rel="noopener">跳转官方文档</a></p><p><img src="/2018/09/29/小程序swiper-bindChange重复执行/swiper_01.png" alt="swiper_01"></p><p>这时候可以发现, 我确实是在 <code>bindChange</code> 绑定的方法里面使用了 <code>setData()</code> 这个方法, 来保证swiper组件的 current 属性与我们的 this.data.activeIndex 保持同步.</p><p>为什么要有 <code>this.data.activeIndex</code> 这个变量？是因为我们要获得当前的页数进行其他的操作。比如底部的 tab 就用到这个变量。但是这个变量必须在 bindChange 进行同步。</p><p>至此，我们的程序在快速滑动的时候是有问题的。不断触发setData()。此外，在官方的开发社区找到这么一条：</p><p><img src="/2018/09/29/小程序swiper-bindChange重复执行/swiper_02.png" alt="swiper_02"></p><p>后来一想，在<code>bindChange</code>改变 swiper 的 current 是有问题的，那么，改变另外的变量呢？答案是没有问题的。</p><p>那么，解决办法就是在 data 里定义2个变量：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 组件的初始数据</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">data: &#123;</span><br><span class="line">    cur: <span class="number">0</span>, <span class="comment">//改变当前索引</span></span><br><span class="line">    activeIndex: <span class="number">0</span> <span class="comment">//当前的索引</span></span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><p>当前的页数用 activeIndex 来标记。swiper组件的current属性我们用变量cur。互不干扰。</p><p>当页面变化时，我们设置 activeIndex, 当我们需要改变页面时，我们设置cur</p><p>所以我将之前的代码做了一些修改, 问题就解决啦~~~~</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"tabview"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"tabs &#123;&#123;position == 'top'?'top':'bottom'&#125;&#125;"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">block</span> <span class="attr">wx:for</span>=<span class="string">"&#123;&#123;tabs&#125;&#125;"</span> <span class="attr">wx:key</span>=<span class="string">"index"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"tab-son &#123;&#123;activeIndex ==index?'active':''&#125;&#125;"</span> <span class="attr">data-index</span>=<span class="string">"&#123;&#123;index&#125;&#125;"</span> <span class="attr">bindtap</span>=<span class="string">'toggleTab'</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">image</span> <span class="attr">class</span>=<span class="string">'tab-icon'</span> <span class="attr">src</span>=<span class="string">'&#123;&#123;activeIndex ==index?item.selectedIcon:item.icon&#125;&#125;'</span> <span class="attr">mode</span>=<span class="string">'aspectFit'</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">'tab-text'</span>&gt;</span>&#123;&#123;item.name&#125;&#125;<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">block</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">swiper</span> <span class="attr">current</span>=<span class="string">"&#123;&#123;cur&#125;&#125;"</span> <span class="attr">class</span>=<span class="string">"tab-swiper &#123;&#123;position == 'top'?'padding-top':'padding-bottom'&#125;&#125;"</span> <span class="attr">bindchange</span>=<span class="string">"swiperChange"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">swiper-item</span> <span class="attr">wx:for</span>=<span class="string">"&#123;&#123;tabs&#125;&#125;"</span> <span class="attr">wx:key</span>=<span class="string">"&#123;&#123;index&#125;&#125;"</span> <span class="attr">class</span>=<span class="string">"tab-contents"</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">slot</span> <span class="attr">name</span>=<span class="string">"&#123;&#123;index&#125;&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">swiper-item</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">swiper</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 组件的方法列表</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">methods: &#123;</span><br><span class="line">    toggleTab: <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> index = e.currentTarget.dataset.index</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">this</span>.data.activeIndex === index) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">this</span>.setData(&#123;</span><br><span class="line">            activeIndex: index,</span><br><span class="line">            cur: index</span><br><span class="line">        &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">var</span> myEventOption = &#123; <span class="attr">activeIndex</span>: index &#125; <span class="comment">// 触发事件的选项</span></span><br><span class="line">        <span class="keyword">this</span>.triggerEvent(<span class="string">'myevent'</span>, myEventOption)</span><br><span class="line">    &#125;,</span><br><span class="line">    swiperChange: <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> activeIndex = e.detail.current</span><br><span class="line">        <span class="keyword">this</span>.setData(&#123;</span><br><span class="line">        activeIndex</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="keyword">var</span> myEventOption = &#123; activeIndex &#125; <span class="comment">// 触发事件的选项</span></span><br><span class="line">        <span class="keyword">this</span>.triggerEvent(<span class="string">'myevent'</span>, myEventOption)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      <categories>
          
          <category> Web前端 </category>
          
          <category> 小程序 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> web 小程序 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>gulp常用插件</title>
      <link href="/2018/09/15/gulp%E5%B8%B8%E7%94%A8%E6%8F%92%E4%BB%B6/"/>
      <url>/2018/09/15/gulp%E5%B8%B8%E7%94%A8%E6%8F%92%E4%BB%B6/</url>
      <content type="html"><![CDATA[<blockquote><p>这里是我学习gulp的时候, 在网上查阅资料中, 相对使用较多的比较常见的好用的一些插件, 在这里记录下来!</p></blockquote><h3 id="自动加载插件"><a href="#自动加载插件" class="headerlink" title="自动加载插件"></a>自动加载插件</h3><p>使用 <a href="https://www.npmjs.com/package/gulp-load-plugins" target="_blank" rel="noopener"><code>gulp-load-plugins</code></a><br>安装：<code>npm install --save-dev gulp-load-plugins</code><br>要使用gulp的插件，首先得用<code>require</code>来把插件加载进来，如果我们要使用的插件非常多，那我们的<code>gulpfile.js</code>文件开头可能就会是这个样子的：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">'gulp'</span>),</span><br><span class="line">    <span class="comment">//一些gulp插件,abcd这些命名只是用来举个例子</span></span><br><span class="line">    a = <span class="built_in">require</span>(<span class="string">'gulp-a'</span>), </span><br><span class="line">    b = <span class="built_in">require</span>(<span class="string">'gulp-b'</span>),</span><br><span class="line">    c = <span class="built_in">require</span>(<span class="string">'gulp-c'</span>),</span><br><span class="line">    d = <span class="built_in">require</span>(<span class="string">'gulp-d'</span>),</span><br><span class="line">    e = <span class="built_in">require</span>(<span class="string">'gulp-e'</span>),</span><br><span class="line">    f = <span class="built_in">require</span>(<span class="string">'gulp-f'</span>),</span><br><span class="line">    g = <span class="built_in">require</span>(<span class="string">'gulp-g'</span>),</span><br><span class="line">    <span class="comment">//更多的插件...</span></span><br><span class="line">    z = <span class="built_in">require</span>(<span class="string">'gulp-z'</span>);   <span class="number">1234567891011</span></span><br></pre></td></tr></table></figure><p>虽然这没什么问题，但会使我们的<code>gulpfile.js</code>文件变得很冗长，看上去不那么舒服。<code>gulp-load-plugins</code>插件正是用来解决这个问题。<br><code>gulp-load-plugins</code>这个插件能自动帮你加载<code>package.json</code>文件里的gulp插件。例如假设你的<code>package.json</code>文件里的依赖是这样的：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"devDependencies"</span>: &#123;</span><br><span class="line">    <span class="string">"gulp"</span>: <span class="string">"~3.6.0"</span>,</span><br><span class="line">    <span class="string">"gulp-rename"</span>: <span class="string">"~1.2.0"</span>,</span><br><span class="line">    <span class="string">"gulp-ruby-sass"</span>: <span class="string">"~0.4.3"</span>,</span><br><span class="line">    <span class="string">"gulp-load-plugins"</span>: <span class="string">"~0.5.1"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>然后我们可以在<code>gulpfile.js</code>中使用<code>gulp-load-plugins</code>来帮我们加载插件：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">'gulp'</span>);</span><br><span class="line"><span class="comment">//加载gulp-load-plugins插件，并马上运行它</span></span><br><span class="line"><span class="keyword">var</span> plugins = <span class="built_in">require</span>(<span class="string">'gulp-load-plugins'</span>)();</span><br></pre></td></tr></table></figure><p>然后我们要使用<code>gulp-rename</code>和<code>gulp-ruby-sass</code>这两个插件的时候，就可以使用<code>plugins.rename</code>和<code>plugins.rubySass</code>来代替了,也就是原始插件名去掉<code>gulp-</code>前缀，之后再转换为驼峰命名。<br>实质上<code>gulp-load-plugins</code>是为我们做了如下的转换：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">plugins.rename = <span class="built_in">require</span>(<span class="string">'gulp-rename'</span>);</span><br><span class="line">plugins.rubySass = <span class="built_in">require</span>(<span class="string">'gulp-ruby-sass'</span>);</span><br></pre></td></tr></table></figure><p><code>gulp-load-plugins</code>并不会一开始就加载所有<code>package.json</code>里的gulp插件，而是在我们需要用到某个插件的时候，才去加载那个插件。最后要提醒的一点是，因为<code>gulp-load-plugins</code>是通过你的<code>package.json</code>文件来加载插件的，所以必须要保证你需要自动加载的插件已经写入到了<code>package.json</code>文件里，并且这些插件都是已经安装好了的。</p><h3 id="重命名"><a href="#重命名" class="headerlink" title="重命名"></a>重命名</h3><p>使用 <a href="https://www.npmjs.com/package/gulp-rename" target="_blank" rel="noopener"><code>gulp-rename</code></a><br>安装：<code>npm install --save-dev gulp-rename</code><br>用来重命名文件流中的文件。用<code>gulp.dest()</code>方法写入文件时，文件名使用的是文件流中的文件名，如果要想改变文件名，那可以在之前用<code>gulp-rename</code>插件来改变文件流中的文件名。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">'gulp'</span>),</span><br><span class="line">    rename = <span class="built_in">require</span>(<span class="string">'gulp-rename'</span>),</span><br><span class="line">    uglify = <span class="built_in">require</span>(<span class="string">"gulp-uglify"</span>);</span><br><span class="line"></span><br><span class="line">gulp.task(<span class="string">'rename'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    gulp.src(<span class="string">'js/jquery.js'</span>)</span><br><span class="line">    .pipe(uglify())  <span class="comment">//压缩</span></span><br><span class="line">    .pipe(rename(<span class="string">'jquery.min.js'</span>)) <span class="comment">//会将jquery.js重命名为jquery.min.js</span></span><br><span class="line">    .pipe(gulp.dest(<span class="string">'js'</span>));</span><br><span class="line">    <span class="comment">//关于gulp-rename的更多强大的用法请参考https://www.npmjs.com/package/gulp-rename</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="js文件压缩"><a href="#js文件压缩" class="headerlink" title="js文件压缩"></a>js文件压缩</h3><p>使用 <a href="https://www.npmjs.com/package/gulp-uglify" target="_blank" rel="noopener"><code>gulp-uglify</code></a><br>安装：<code>npm install --save-dev gulp-uglify</code><br>用来压缩js文件，使用的是<code>uglify</code>引擎</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">'gulp'</span>),</span><br><span class="line">    uglify = <span class="built_in">require</span>(<span class="string">"gulp-uglify"</span>);</span><br><span class="line"></span><br><span class="line">gulp.task(<span class="string">'minify-js'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    gulp.src(<span class="string">'js/*.js'</span>) <span class="comment">// 要压缩的js文件</span></span><br><span class="line">    .pipe(uglify())  <span class="comment">//使用uglify进行压缩,更多配置请参考：</span></span><br><span class="line">    .pipe(gulp.dest(<span class="string">'dist/js'</span>)); <span class="comment">//压缩后的路径</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="js模块化构建"><a href="#js模块化构建" class="headerlink" title="js模块化构建"></a>js模块化构建</h3><p>使用 <a href="https://www.npmjs.com/package/gulp-browserify" target="_blank" rel="noopener"><code>gulp-browserify</code></a><br>安装：<code>npm install --save-dev gulp-browserify</code></p><p>前端js代码的模块化一直是前端工程师之痛，因为JS在ES6之前不支持 <code>import</code> 或者 <code>require</code> 这类的模块加载能力，需要借助 一些工具，比如 <code>requireJS</code>、<code>seaJS</code>等。但是 有了 <code>browserify</code>，js代码代码只要编译之后，你可以大胆地 使用<code>require()</code>，就像在<code>node</code>环境里一样，而且它既支持<code>commonJS</code>规范，也支持非<code>commonJS</code>规范，但是为了提高准确率，还是自觉遵守<code>commonJS</code>规范吧！</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">'gulp'</span>);</span><br><span class="line"><span class="keyword">var</span> browserify = <span class="built_in">require</span>(<span class="string">'gulp-browserify'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 处理javascript </span></span><br><span class="line">gulp.task(<span class="string">'scripts'</span>, [<span class="string">'clean'</span>], <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> gulp.src(<span class="string">'src/js/**/*.js'</span>)</span><br><span class="line">        .pipe(browserify())</span><br><span class="line">        .pipe(gulp.dest(JS_DEST));</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="css文件压缩"><a href="#css文件压缩" class="headerlink" title="css文件压缩"></a>css文件压缩</h3><p>使用 <a href="https://www.npmjs.com/package/gulp-minify-css" target="_blank" rel="noopener"><code>gulp-minify-css</code></a><br>安装：<code>npm install --save-dev gulp-minify-css</code><br>要压缩css文件时可以使用该插件</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">'gulp'</span>),</span><br><span class="line">    minifyCss = <span class="built_in">require</span>(<span class="string">"gulp-minify-css"</span>);</span><br><span class="line"></span><br><span class="line">gulp.task(<span class="string">'minify-css'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    gulp.src(<span class="string">'css/*.css'</span>) <span class="comment">// 要压缩的css文件</span></span><br><span class="line">    .pipe(minifyCss()) <span class="comment">//压缩css</span></span><br><span class="line">    .pipe(gulp.dest(<span class="string">'dist/css'</span>));</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="html文件压缩"><a href="#html文件压缩" class="headerlink" title="html文件压缩"></a>html文件压缩</h3><p>使用 <a href="https://www.npmjs.com/package/gulp-minify-html" target="_blank" rel="noopener"><code>gulp-minify-html</code></a><br>安装：<code>npm install --save-dev gulp-minify-html</code><br>用来压缩html文件</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">'gulp'</span>),</span><br><span class="line">    minifyHtml = <span class="built_in">require</span>(<span class="string">"gulp-minify-html"</span>);</span><br><span class="line"></span><br><span class="line">gulp.task(<span class="string">'minify-html'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    gulp.src(<span class="string">'html/*.html'</span>) <span class="comment">// 要压缩的html文件</span></span><br><span class="line">    .pipe(minifyHtml()) <span class="comment">//压缩</span></span><br><span class="line">    .pipe(gulp.dest(<span class="string">'dist/html'</span>));</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="js代码检查"><a href="#js代码检查" class="headerlink" title="js代码检查"></a>js代码检查</h3><p>使用 <a href="https://www.npmjs.com/package/gulp-jshint" target="_blank" rel="noopener"><code>gulp-jshint</code></a><br>安装：<code>npm install --save-dev gulp-jshint</code><br>用来检查js代码</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">'gulp'</span>),</span><br><span class="line">    jshint = <span class="built_in">require</span>(<span class="string">"gulp-jshint"</span>);</span><br><span class="line"></span><br><span class="line">gulp.task(<span class="string">'jsLint'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    gulp.src(<span class="string">'js/*.js'</span>)</span><br><span class="line">    .pipe(jshint())</span><br><span class="line">    .pipe(jshint.reporter()); <span class="comment">// 输出检查结果</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="文件合并"><a href="#文件合并" class="headerlink" title="文件合并"></a>文件合并</h3><p>使用 <a href="https://www.npmjs.com/package/gulp-concat" target="_blank" rel="noopener"><code>gulp-concat</code></a><br>安装：<code>npm install --save-dev gulp-concat</code><br>用来把多个文件合并为一个文件,我们可以用它来合并js或css文件等，这样就能减少页面的http请求数了</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">'gulp'</span>),</span><br><span class="line">    concat = <span class="built_in">require</span>(<span class="string">"gulp-concat"</span>);</span><br><span class="line"></span><br><span class="line">gulp.task(<span class="string">'concat'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    gulp.src(<span class="string">'js/*.js'</span>)  <span class="comment">//要合并的文件</span></span><br><span class="line">    .pipe(concat(<span class="string">'all.js'</span>))  <span class="comment">// 合并匹配到的js文件并命名为 "all.js"</span></span><br><span class="line">    .pipe(gulp.dest(<span class="string">'dist/js'</span>));</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="less和sass的编译"><a href="#less和sass的编译" class="headerlink" title="less和sass的编译"></a>less和sass的编译</h3><p>less使用 <a href="https://www.npmjs.com/package/gulp-less" target="_blank" rel="noopener"><code>gulp-less</code></a><br>安装：<code>npm install --save-dev gulp-less</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">'gulp'</span>),</span><br><span class="line">    less = <span class="built_in">require</span>(<span class="string">"gulp-less"</span>);</span><br><span class="line"></span><br><span class="line">gulp.task(<span class="string">'compile-less'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    gulp.src(<span class="string">'less/*.less'</span>)</span><br><span class="line">    .pipe(less())</span><br><span class="line">    .pipe(gulp.dest(<span class="string">'dist/css'</span>));</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>sass使用 <a href="https://www.npmjs.com/package/gulp-sass" target="_blank" rel="noopener"><code>gulp-sass</code></a><br>安装：<code>npm install --save-dev gulp-sass</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">'gulp'</span>),</span><br><span class="line">    sass = <span class="built_in">require</span>(<span class="string">"gulp-sass"</span>);</span><br><span class="line"></span><br><span class="line">gulp.task(<span class="string">'compile-sass'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    gulp.src(<span class="string">'sass/*.sass'</span>)</span><br><span class="line">    .pipe(sass())</span><br><span class="line">    .pipe(gulp.dest(<span class="string">'dist/css'</span>));</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="图片压缩"><a href="#图片压缩" class="headerlink" title="图片压缩"></a>图片压缩</h3><p>可以使用 <a href="https://www.npmjs.com/package/gulp-imagemin" target="_blank" rel="noopener"><code>gulp-imagemin</code></a>插件来压缩jpg、png、gif等图片。<br>安装：<code>npm install --save-dev gulp-imagemin</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">'gulp'</span>);</span><br><span class="line"><span class="keyword">var</span> imagemin = <span class="built_in">require</span>(<span class="string">'gulp-imagemin'</span>);</span><br><span class="line"><span class="keyword">var</span> pngquant = <span class="built_in">require</span>(<span class="string">'imagemin-pngquant'</span>); <span class="comment">//png图片压缩插件</span></span><br><span class="line"><span class="keyword">var</span> cache = <span class="built_in">require</span>(<span class="string">'gulp-cache'</span>);  <span class="comment">//只压缩修改的图片，没有修改的图片直接从缓存文件读取</span></span><br><span class="line"></span><br><span class="line">gulp.task(<span class="string">'default'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> gulp.src(<span class="string">'src/images/*'</span>)</span><br><span class="line">        .pipe(cache(imagemin(&#123;</span><br><span class="line">            optimizationLevel: <span class="number">5</span>, <span class="comment">//类型：Number  默认：3  取值范围：0-7（优化等级）</span></span><br><span class="line">            progressive: <span class="literal">true</span>, <span class="comment">//类型：Boolean 默认：false 无损压缩jpg图片</span></span><br><span class="line">            interlaced: <span class="literal">true</span>, <span class="comment">//类型：Boolean 默认：false 隔行扫描gif进行渲染</span></span><br><span class="line">            multipass: <span class="literal">true</span>, <span class="comment">//类型：Boolean 默认：false 多次优化svg直到完全优化</span></span><br><span class="line">            svgoPlugins: [&#123;<span class="attr">removeViewBox</span>: <span class="literal">false</span>&#125;],  <span class="comment">//不要移除svg的viewbox属性</span></span><br><span class="line">            use: [pngquant()] <span class="comment">//使用pngquant来压缩png图片   </span></span><br><span class="line">        &#125;)))</span><br><span class="line">        .pipe(gulp.dest(<span class="string">'dist'</span>));</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p><code>gulp-imagemin</code>的使用比较复杂一点，而且它本身也有很多插件，建议去它的项目<a href="https://github.com/sindresorhus/gulp-imagemin" target="_blank" rel="noopener">主页</a>看看文档</p><h3 id="自动刷新"><a href="#自动刷新" class="headerlink" title="自动刷新"></a>自动刷新</h3><p>使用<a href="https://www.npmjs.com/package/gulp-livereload" target="_blank" rel="noopener"><code>gulp-livereload</code></a>插件，安装: <code>npm install --save-dev gulp-livereload</code><br>当代码变化时，它可以帮我们自动刷新页面<br>该插件最好配合谷歌浏览器来使用，且要安装 <code>livereload chrome extension</code> 扩展插件,不能下载的请自行FQ。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">'gulp'</span>),</span><br><span class="line">    less = <span class="built_in">require</span>(<span class="string">'gulp-less'</span>),</span><br><span class="line">    livereload = <span class="built_in">require</span>(<span class="string">'gulp-livereload'</span>);</span><br><span class="line"></span><br><span class="line">gulp.task(<span class="string">'less'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  gulp.src(<span class="string">'less/*.less'</span>)</span><br><span class="line">    .pipe(less())</span><br><span class="line">    .pipe(gulp.dest(<span class="string">'css'</span>))</span><br><span class="line">    .pipe(livereload());</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">gulp.task(<span class="string">'watch'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  livereload.listen(); <span class="comment">//要在这里调用listen()方法</span></span><br><span class="line">  gulp.watch(<span class="string">'less/*.less'</span>, [<span class="string">'less'</span>]);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="清理编译环境"><a href="#清理编译环境" class="headerlink" title="清理编译环境"></a>清理编译环境</h3><p>使用 <a href="https://www.npmjs.com/package/gulp-clean" target="_blank" rel="noopener"><code>gulp-clean</code></a><br>安装 <code>npm install gulp-clean --save-dev</code><br>提交代码之前我们需要把本地的编译环境清理干净。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> clean = <span class="built_in">require</span>(<span class="string">'gulp-clean'</span>);</span><br><span class="line">gulp.task(<span class="string">'clean'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> gulp.src([<span class="string">'dist/assets/css'</span>,<span class="string">'dist/assets/js'</span>,<span class="string">'dist/assets/img'</span>],&#123;<span class="attr">read</span>: <span class="literal">false</span>&#125;).pipe(clean());</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>我们可以传入一个目录（或档案）阵列到<code>gulp.src()</code>。因为我们不需要读取已经被删除的档案，我们可以加入<code>read:false</code> 选项来防止gulp读取档案内容让它快一些。</p><h3 id="我的gulpfile-js"><a href="#我的gulpfile-js" class="headerlink" title="我的gulpfile.js"></a>我的gulpfile.js</h3><p>下面的是我花了一下午研究出来的gulp前端自动化管理的最佳实践的gulpfile.js这个文件的代码</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">'use strict'</span>;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 1. CSS压缩 合并</span></span><br><span class="line"><span class="comment"> * 2. JS合并 压缩 混淆</span></span><br><span class="line"><span class="comment"> * 3. img复制</span></span><br><span class="line"><span class="comment"> * 4. html压缩</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 导入工具包 require('node_modules里对应模块')</span></span><br><span class="line"><span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">'gulp'</span>);  <span class="comment">// gulp核心模块</span></span><br><span class="line"><span class="keyword">var</span> plugins = <span class="built_in">require</span>(<span class="string">'gulp-load-plugins'</span>)(); <span class="comment">// gulp插件加载模块</span></span><br><span class="line"><span class="keyword">var</span> env = process.env.NODE_ENV || <span class="string">'development'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 在这里定义一些常量以供使用</span></span><br><span class="line"><span class="keyword">var</span> DEST = <span class="string">'dist'</span>;</span><br><span class="line"><span class="keyword">var</span> HTML_DEST = <span class="string">'dist'</span>;     <span class="comment">// html编译目录</span></span><br><span class="line"><span class="keyword">var</span> CSS_DEST = <span class="string">'dist/static/css'</span>;  <span class="comment">// css编译目录</span></span><br><span class="line"><span class="keyword">var</span> JS_DEST = <span class="string">'dist/static/js'</span>;    <span class="comment">// js编译目录</span></span><br><span class="line"><span class="keyword">var</span> IMG_DEST = <span class="string">'dist/static/img'</span>;  <span class="comment">// img编译目录</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 处理html</span></span><br><span class="line">gulp.task(<span class="string">'minify-html'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> options = &#123;</span><br><span class="line">        removeComments: <span class="literal">true</span>, <span class="comment">//清除HTML注释</span></span><br><span class="line">        collapseWhitespace: <span class="literal">true</span>, <span class="comment">//压缩HTML</span></span><br><span class="line">        removeEmptyAttributes: <span class="literal">true</span>, <span class="comment">//删除所有空格作属性值 &lt;input id="" /&gt; ==&gt; &lt;input /&gt;</span></span><br><span class="line">        minifyJS: <span class="literal">true</span>, <span class="comment">//压缩页面JS</span></span><br><span class="line">        minifyCSS: <span class="literal">true</span> <span class="comment">//压缩页面CSS</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">// 返回一个stream, 以实现异步执行</span></span><br><span class="line">    <span class="keyword">return</span> gulp.src(<span class="string">'src/*.html'</span>) <span class="comment">// 要压缩的html文件</span></span><br><span class="line">        .pipe(plugins.htmlmin(options)) <span class="comment">// 压缩html</span></span><br><span class="line">        .pipe(gulp.dest(HTML_DEST))</span><br><span class="line">        .pipe(plugins.livereload())</span><br><span class="line">        .pipe(plugins.notify(&#123;</span><br><span class="line">            message: <span class="string">'minify-html task complete'</span></span><br><span class="line">        &#125;));</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 处理JS: 压缩合并混淆</span></span><br><span class="line">gulp.task(<span class="string">'scripts'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> gulp.src(<span class="string">'src/static/js/*.js'</span>) <span class="comment">// 要压缩的js文件</span></span><br><span class="line">        .pipe(plugins.jshint()) <span class="comment">// js代码规范</span></span><br><span class="line">        .pipe(plugins.jshint.reporter(<span class="string">'default'</span>)) <span class="comment">// 输出检查结果</span></span><br><span class="line">        .pipe(plugins.browserify()) <span class="comment">// js模块化构建</span></span><br><span class="line">        .pipe(plugins.uglify()) <span class="comment">// 使用uglify进行压缩</span></span><br><span class="line">        .pipe(gulp.dest(JS_DEST)) <span class="comment">// 压缩后的路径</span></span><br><span class="line">        .pipe(plugins.livereload())</span><br><span class="line">        .pipe(plugins.notify(&#123;</span><br><span class="line">            message: <span class="string">'Scripts task complete'</span></span><br><span class="line">        &#125;));</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 处理css: 压缩合并</span></span><br><span class="line">gulp.task(<span class="string">'minify-css'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> gulp.src([<span class="string">'src/static/css/*.css'</span>, <span class="string">'src/static/css/**/*.css'</span>]) <span class="comment">// 要压缩的css文件</span></span><br><span class="line">        .pipe(plugins.autoprefixer()) <span class="comment">// 自动处理浏览器前缀</span></span><br><span class="line">        .pipe(plugins.minifyCss())  <span class="comment">// 压缩css</span></span><br><span class="line">        .pipe(gulp.dest(CSS_DEST))</span><br><span class="line">        .pipe(plugins.livereload()) </span><br><span class="line">        .pipe(plugins.notify(&#123;</span><br><span class="line">            message: <span class="string">'minify-css task complete'</span></span><br><span class="line">        &#125;));</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 处理图片</span></span><br><span class="line"><span class="keyword">var</span> pngquant = <span class="built_in">require</span>(<span class="string">'imagemin-pngquant'</span>);</span><br><span class="line">gulp.task(<span class="string">'images'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> gulp.src([<span class="string">'src/static/img/**/*'</span>, <span class="string">'src/static/img/*'</span>])</span><br><span class="line">        .pipe(plugins.cache(plugins.imagemin(&#123;  <span class="comment">// 只压缩修改的图片, 没修改的从缓存取</span></span><br><span class="line">            optimizationLevel: <span class="number">5</span>,  <span class="comment">// 优化等级(取值范围：0-7)  类型：Number  默认：3</span></span><br><span class="line">            progressive: <span class="literal">true</span>,  <span class="comment">// 无损压缩jpg图片  类型：Boolean 默认：false</span></span><br><span class="line">            interlaced: <span class="literal">true</span>,  <span class="comment">// 隔行扫描gif进行渲染 类型：Boolean 默认：false</span></span><br><span class="line">            svgoPlugins: [&#123;<span class="attr">removeViewBox</span>: <span class="literal">false</span>&#125;],  <span class="comment">//不要移除svg的viewbox属性</span></span><br><span class="line">            use: [pngquant()]  <span class="comment">// 使用pngquant深度压缩png图片的imagemin插件</span></span><br><span class="line">        &#125;)))</span><br><span class="line">        .pipe(gulp.dest(IMG_DEST))</span><br><span class="line">        .pipe(plugins.livereload())</span><br><span class="line">        .pipe(plugins.notify(&#123;</span><br><span class="line">            message: <span class="string">'Images task complete'</span></span><br><span class="line">        &#125;))</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//  直接拷贝不需要处理的文件夹</span></span><br><span class="line">gulp.task(<span class="string">'copy'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> gulp.src(<span class="string">'src/static/plugins/**/*'</span>)</span><br><span class="line">        .pipe(gulp.dest(<span class="string">'dist/static/plugins'</span>))</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 清理dist目录</span></span><br><span class="line">gulp.task(<span class="string">'clean'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// read 设置为 false，则不会去读取文件</span></span><br><span class="line">    <span class="keyword">return</span> gulp.src([HTML_DEST, CSS_DEST, JS_DEST, IMG_DEST], &#123; <span class="attr">read</span>: <span class="literal">false</span> &#125;)</span><br><span class="line">        .pipe(plugins.clean())</span><br><span class="line">        .pipe(plugins.notify(&#123;</span><br><span class="line">            message: <span class="string">'Clean task complete'</span></span><br><span class="line">        &#125;));</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 开启一个静态文件服务</span></span><br><span class="line">gulp.task(<span class="string">'server'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    gulp.src(<span class="string">'dist'</span>)</span><br><span class="line">        .pipe(plugins.webserver(&#123;</span><br><span class="line">            livereload: <span class="literal">true</span>,</span><br><span class="line">            directoryListing: &#123;</span><br><span class="line">                path: <span class="string">'index.html'</span>, <span class="comment">//你web资源的起始页，在dist目录下</span></span><br><span class="line">                enable: <span class="literal">true</span></span><br><span class="line">            &#125;,</span><br><span class="line">            open: <span class="literal">true</span>  <span class="comment">// 自动打开浏览器</span></span><br><span class="line">        &#125;));</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 监听文件变化</span></span><br><span class="line">gulp.task(<span class="string">'watch'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 监听livereload</span></span><br><span class="line">    plugins.livereload.listen();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 监听html</span></span><br><span class="line">    gulp.watch(<span class="string">'src/*.html'</span>, [<span class="string">'minify-html'</span>]);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 监听css</span></span><br><span class="line">    gulp.watch([<span class="string">'src/static/css/*.css'</span>, <span class="string">'src/static/css/**/*.css'</span>], [<span class="string">'minify-css'</span>]);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 监听js</span></span><br><span class="line">    gulp.watch(<span class="string">'src/static/js/*.js'</span>, [<span class="string">'scripts'</span>]);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 监听图片</span></span><br><span class="line">    gulp.watch([<span class="string">'src/static/img/**/*'</span>, <span class="string">'src/static/img/*'</span>], [<span class="string">'images'</span>]);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// build任务</span></span><br><span class="line">gulp.task(<span class="string">'build'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">cb</span>) </span>&#123;</span><br><span class="line">    plugins.sequence(<span class="string">'clean'</span>, [<span class="string">'minify-html'</span>, <span class="string">'scripts'</span>, <span class="string">'images'</span>, <span class="string">'minify-css'</span>, <span class="string">'copy'</span>, <span class="string">'watch'</span>])(cb)</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 主任务</span></span><br><span class="line">gulp.task(<span class="string">'main'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">cb</span>) </span>&#123;</span><br><span class="line">    plugins.sequence(<span class="string">'build'</span>, [<span class="string">'server'</span>])(cb)</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 默认任务</span></span><br><span class="line">gulp.task(<span class="string">'default'</span>, [<span class="string">'main'</span>]);</span><br></pre></td></tr></table></figure>]]></content>
      
      <categories>
          
          <category> Web前端 </category>
          
          <category> 构建工具 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> web 自动化 构建工具 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>gulp详细入门教程</title>
      <link href="/2018/09/13/gulp%E8%AF%A6%E7%BB%86%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/"/>
      <url>/2018/09/13/gulp%E8%AF%A6%E7%BB%86%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/</url>
      <content type="html"><![CDATA[<blockquote><p>前言: 每当我比较闲的时候呢, 我们组长就给我安排学习任务了, 这不, 要求我这两天学习一下gulp这个打包工具, 那么顺便就把学习到的知识点记录下来咯! 以便以后复习使用。这里我就引用一段套话吧, 大家看看就好: gulp是前端开发过程中对代码进行构建的工具，是自动化项目的构建利器；她不仅能对网站资源进行优化，而且在开发过程中很多重复的任务能够使用正确的工具自动完成；使用她，我们不仅可以很愉快的编写代码，而且大大提高我们的工作效率。</p></blockquote><p>&emsp;&emsp;在学习前，先谈谈大致使用 gulp 的步骤，给读者以初步的认识。首先当然是安装nodejs，通过 nodejs 的 npm 全局安装和项目安装 gulp，其次在项目里安装所需要的 gulp 插件，然后新建 gulp 的配置文件<code>gulpfile.js</code>并写好配置信息（定义gulp任务），最后通过命令提示符运行gulp任务即可。</p><h3 id="安装-gulp-以及其他依赖"><a href="#安装-gulp-以及其他依赖" class="headerlink" title="安装 gulp 以及其他依赖"></a>安装 gulp 以及其他依赖</h3><ul><li><ol><li>全局安装 gulp (为了通过它来执行gulp任务)<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 执行安装命令</span></span><br><span class="line">npm install gulp -g</span><br><span class="line"></span><br><span class="line"><span class="comment">// 查看版本号</span></span><br><span class="line">gulp -v</span><br></pre></td></tr></table></figure></li></ol></li><li><ol start="2"><li>新建 package.json 文件</li></ol></li></ul><p>执行命令 <code>npm init</code><br>package.json是基于nodejs项目必不可少的配置文件，它是存放在项目根目录的普通json文件；</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  "name": "test",   //项目名称（必须）</span><br><span class="line">  "version": "1.0.0",   //项目版本（必须）</span><br><span class="line">  "description": "This is for study gulp project !",   //项目描述（必须）</span><br><span class="line">  "homepage": "",   //项目主页</span><br><span class="line">  "repository": &#123;    //项目资源库</span><br><span class="line">    "type": "git",</span><br><span class="line">    "url": "https://git.oschina.net/xxxx"</span><br><span class="line">  &#125;,</span><br><span class="line">  "author": &#123;    //项目作者信息</span><br><span class="line">    "name": "surging",</span><br><span class="line">    "email": "surging2@qq.com"</span><br><span class="line">  &#125;,</span><br><span class="line">  "license": "ISC",    //项目许可协议</span><br><span class="line">  "devDependencies": &#123;    //项目依赖的插件</span><br><span class="line">    "gulp": "^3.8.11",</span><br><span class="line">    "gulp-less": "^3.0.0"</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><ol start="3"><li>本地安装 gulp 以及其他插件</li></ol></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 执行安装命令</span></span><br><span class="line">npm install gulp --save-dev</span><br></pre></td></tr></table></figure><p><font color="skyblue">细心的你可能会发现，我们全局安装了gulp，项目也安装了gulp，全局安装gulp是为了执行gulp任务，本地安装gulp则是为了调用gulp插件的功能。<font></font></font></p><ul><li><ol start="4"><li>新建gulpfile.js文件（重要)<br>说明：gulpfile.js是gulp项目的配置文件，是位于项目根目录的普通js文件（其实将gulpfile.js放入其他文件夹下亦可）</li></ol></li><li><ol start="5"><li>运行gulp<br>命令提示符执行 <code>gulp 任务名称</code><br>当执行<code>gulp default</code>或<code>gulp将</code>会调用 default 任务里的所有任务</li></ol></li></ul><h3 id="详解-gulp-的-API"><a href="#详解-gulp-的-API" class="headerlink" title="详解 gulp 的 API"></a>详解 gulp 的 API</h3><p>&emsp;&emsp;要运行 gulp 任务，只需切换到存放<code>gulpfile.js</code>文件的目录( windows 平台请使用 cmd 或者 Power Shell 等工具)，然后在命令行中执行 gulp 命令就行了，gulp 后面可以加上要执行的任务名，例如 gulp task1，如果没有指定任务名，则会执行任务名为 default 的默认任务。</p><p>&emsp;&emsp;使用 gulp，仅需知道 4 个 API 即可：gulp.task(), gulp.src(), gulp.dest(), gulp.watch()，所以很容易就能掌握，但有几个地方需理解透彻才行。往下看…</p><h4 id="gulp-src"><a href="#gulp-src" class="headerlink" title="gulp.src()"></a>gulp.src()</h4><p>获取文件流。注意这个流里的内容不是原始的文件流，而是一个虚拟文件对象流(<code>Vinyl files</code>)，这个虚拟文件对象中存储着原始文件的路径、文件名、内容等信息，基本语法为：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gulp.src([globs], option)</span><br></pre></td></tr></table></figure><blockquote><p>globs 参数是文件匹配模式(类似正则表达式), 用来匹配文件路径(包括文件名), 当然这里也可直接指定某个具体的文件路径. 当有多个匹配模式时, 该参数可以为一个数组. option 为可选参数, 通常情况下不需要用到.</p></blockquote><ul><li><p>下面重点介绍gulp常用的glob匹配规则和技巧：</p><ul><li><backcode>*</backcode>匹配文件路径中的0个或多个字符，但不会匹配路径分隔符，除非路径分隔符出现在末尾</li><li><backcode>**</backcode> 匹配路径中的0个或多个目录及其子目录,需要单独出现，即它左右不能有其他东西了。如果出现在末尾，也能匹配文件。</li><li><backcode>?</backcode> 匹配文件路径中的一个字符(不会匹配路径分隔符)</li><li><backcode>[…]</backcode> 匹配方括号中出现的字符中的任意一个，当方括号中第一个字符为^或!时，则表示不匹配方括号中出现的其他字符中的任意一个，类似js正则表达式中的用法</li><li><backcode>!(pattern|pattern|pattern)</backcode> 匹配任何与括号中给定的任一模式都不匹配的</li><li><backcode>?(pattern|pattern|pattern)</backcode> 匹配括号中给定的任一模式0次或1次，类似于js正则中的 (pattern|pattern|pattern)?</li><li><backcode>+(pattern|pattern|pattern)</backcode> 匹配括号中给定的任一模式至少1次，类似于js正则中的(pattern|pattern|pattern)+</li><li><backcode> <em> (pattern|pattern|pattern)</em></backcode> 匹配括号中给定的任一模式0次或多次，类似于js正则中的(pattern|pattern|pattern)</li><li><backcode>@(pattern|pattern|pattern)</backcode> 匹配括号中给定的任一模式1次，类似于js正则中的(pattern|pattern|pattern)</li></ul></li><li><p>语法看起来太枯燥，我们还是结合实际场景看看：</p><ul><li><backcode>*</backcode> 能匹配 <backcode>a.js, x.y, abc, abc/</backcode>,但不能匹配<backcode>a/b.js</backcode></li><li><backcode><em>.</em></backcode> 能匹配 <backcode>a.js, style.css, a.b,x.y</backcode></li><li><backcode><em>/</em>/*.js</backcode> 能匹配 <backcode>a/b/c.js, x/y/z.js</backcode>,不能匹配<backcode>a/b.js, a/b/c/d.js</backcode></li><li><backcode>**</backcode> 能匹配 <backcode>abc, a/b.js, a/b/c.js, x/y/z, x/y/z/a.b</backcode>,能用来匹配所有的目录和文件</li><li><backcode>*<em>/</em>.js</backcode> 能匹配 <backcode>foo.js, a/foo.js, a/b/foo.js, a/b/c/foo.js</backcode></li><li><backcode>a/**/z</backcode> 能匹配 <backcode>a/z, a/b/z, a/b/c/z, a/d/g/h/j/k/z</backcode></li><li><backcode>a/<strong>b/z</strong></backcode> 能匹配 <backcode>a/b/z, a/sb/z</backcode>,但不能匹配<backcode>a/x/sb/z</backcode>,因为只有单<backcode></backcode>单独出现才能匹配多级目录</li><li><backcode>?.js</backcode> 能匹配 <backcode>a.js, b.js, c.js</backcode></li><li><backcode>a??</backcode> 能匹配 <backcode>a.b, abc</backcode>,但不能匹配<backcode>ab/</backcode>,因为它不会匹配路径分隔符</li><li><backcode>[xyz].js</backcode> 只能匹配 <backcode>x.js, y.js, z.js</backcode>,不会匹配 <backcode>xy.js, xyz.js</backcode>等,整个中括号只代表一个字符</li><li><backcode>[^xyz].js</backcode> 能匹配 <backcode>a.js, b.js, c.js</backcode>等,不能匹配 <backcode>x.js, y.js, z.js</backcode></li></ul></li><li><p>当有多种匹配模式时可以使用数组：</p></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gulp.src([<span class="string">'js/*.js'</span>,<span class="string">'css/*.css'</span>,<span class="string">'*.html'</span>])</span><br></pre></td></tr></table></figure><p>使用数组的方式还有一个好处就是可以很方便的使用排除模式，在数组中的单个匹配模式前加上!即是排除模式，它会在匹配的结果中排除这个匹配，要注意一点的是不能在数组中的第一个元素中使用排除模式。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">gulp.src([*.js,<span class="string">'!b*.js'</span>]) <span class="comment">//匹配所有js文件，但排除掉以b开头的js文件</span></span><br><span class="line">gulp.src([<span class="string">'!b*.js'</span>,*.js]) <span class="comment">//不会排除任何文件，因为排除模式不能出现在数组的第一个元素中</span></span><br></pre></td></tr></table></figure><p><font color="skyblue">此外，还可以使用展开模式。</font> 展开模式以花括号作为定界符，根据它里面的内容，会展开为多个模式，最后匹配的结果为所有展开的模式相加起来得到的结果。展开的例子如下：</p><ul><li>a{b,c}d 会展开为 abd, acd</li><li>a{b,}c 会展开为 abc, ac</li><li>a{0..3}d 会展开为 a0d, a1d, a2d, a3d</li><li>a{b,c{d,e}f}g 会展开为 abg, acdfg, acefg</li><li>a{b,c}d{e,f}g 会展开为 abdeg, acdeg, abdeg, abdfg</li></ul><h4 id="gulp-dest"><a href="#gulp-dest" class="headerlink" title="gulp.dest()"></a>gulp.dest()</h4><p>写文件。基本语法为：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gulp.dest([path],options)</span><br></pre></td></tr></table></figure><blockquote><p>path为写入文件的路径，options为一个可选的参数对象，通常我们不需要用到。</p></blockquote><p>gulp的使用流程一般是这样子的：首先通过<code>gulp.src()</code>方法获取到我们想要处理的文件流，然后把文件流通过pipe方法导入到gulp的插件中，最后把经过插件处理后的流再通过<code>pipe</code>方法导入到<code>gulp.dest()</code>中，<code>gulp.dest()</code>方法则把流中的内容写入到文件中，这里首先需要弄清楚的一点是，我们给<code>gulp.dest()</code>传入的路径参数，只能用来指定要生成的文件的目录，而不能指定生成文件的文件名，它生成文件的文件名使用的是导入到它的文件流自身的文件名，所以生成的文件名是由导入到它的文件流决定的，即使我们给它传入一个带有文件名的路径参数，然后它也会把这个文件名当做是目录名，例如：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">'gulp'</span>);</span><br><span class="line">gulp.src(<span class="string">'script/jquery.js'</span>)</span><br><span class="line">    .pipe(gulp.dest(<span class="string">'dist/foo.js'</span>));</span><br><span class="line"><span class="comment">//最终生成的文件路径为 dist/foo.js/jquery.js,而不是dist/foo.js</span></span><br></pre></td></tr></table></figure><p>要想改变文件名，可以使用插件 <a href="https://www.npmjs.com/package/gulp-rename" target="_blank" rel="noopener">gulp-rename</a></p><p>下面说说生成的文件路径与我们给<code>gulp.dest()</code>方法传入的路径参数之间的关系。<br><code>gulp.dest(path)</code> 生成的文件路径是我们传入的<code>path</code>参数后面再加上<code>gulp.src()</code>中有通配符开始出现的那部分路径。例如：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> gulp = reruire(<span class="string">'gulp'</span>);</span><br><span class="line"><span class="comment">//有通配符开始出现的那部分路径为 **/*.js</span></span><br><span class="line">gulp.src(<span class="string">'script/**/*.js'</span>)</span><br><span class="line">    .pipe(gulp.dest(<span class="string">'dist'</span>)); <span class="comment">//最后生成的文件路径为 dist/**/*.js</span></span><br><span class="line"><span class="comment">//如果 **/*.js 匹配到的文件为 jquery/jquery.js ,则生成的文件路径为 dist/jquery/jquery.js</span></span><br></pre></td></tr></table></figure><p>再举更多一点的例子</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">gulp.src(<span class="string">'script/avalon/avalon.js'</span>) <span class="comment">//没有通配符出现的情况</span></span><br><span class="line">    .pipe(gulp.dest(<span class="string">'dist'</span>)); <span class="comment">//最后生成的文件路径为 dist/avalon.js</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//有通配符开始出现的那部分路径为 **/underscore.js</span></span><br><span class="line">gulp.src(<span class="string">'script/**/underscore.js'</span>)</span><br><span class="line">    <span class="comment">//假设匹配到的文件为script/util/underscore.js</span></span><br><span class="line">    .pipe(gulp.dest(<span class="string">'dist'</span>)); <span class="comment">//则最后生成的文件路径为 dist/util/underscore.js</span></span><br><span class="line"></span><br><span class="line">gulp.src(<span class="string">'script/*'</span>) <span class="comment">//有通配符出现的那部分路径为 *</span></span><br><span class="line">    <span class="comment">//假设匹配到的文件为script/zepto.js    </span></span><br><span class="line">    .pipe(gulp.dest(<span class="string">'dist'</span>)); <span class="comment">//则最后生成的文件路径为 dist/zepto.js</span></span><br></pre></td></tr></table></figure><p>通过指定<code>gulp.src()</code>方法配置参数中的<code>base</code>属性，我们可以更灵活的来改变<code>gulp.dest()</code>生成的文件路径。当我们没有在<code>gulp.src()</code>方法中配置base属性时，base的默认值为通配符开始出现之前那部分路径，例如：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gulp.src(<span class="string">'app/src/**/*.css'</span>) <span class="comment">//此时base的值为 app/src</span></span><br></pre></td></tr></table></figure><p>上面我们说的<code>gulp.dest()</code>所生成的文件路径的规则，其实也可以理解成，用我们给<code>gulp.dest()</code>传入的路径替换掉<code>gulp.src()</code>中的<code>base</code>路径，最终得到生成文件的路径。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">gulp.src(<span class="string">'app/src/**/*.css'</span>) <span class="comment">/*此时base的值为app/src,也就是说它的base路径为app/src*/</span></span><br><span class="line">     <span class="comment">/*设该模式匹配到了文件 app/src/css/normal.css*/</span></span><br><span class="line">    .pipe(gulp.dest(<span class="string">'dist'</span>)) <span class="comment">/*用dist替换掉base路径，最终得到 dist/css/normal.css*/</span></span><br></pre></td></tr></table></figure><p>所以改变<code>base</code>路径后，<code>gulp.dest()</code>生成的文件路径也会改变</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">gulp.src(script/lib<span class="comment">/*.js) //没有配置base参数，此时默认的base路径为script/lib</span></span><br><span class="line"><span class="comment">    /*假设匹配到的文件为script/lib/jquery.js*/</span></span><br><span class="line">    .pipe(gulp.dest(<span class="string">'build'</span>)) <span class="comment">//生成的文件路径为 build/jquery.js</span></span><br><span class="line"></span><br><span class="line">gulp.src(script/lib<span class="comment">/*.js, &#123;base:'script'&#125;) //配置了base参数，此时base路径为script</span></span><br><span class="line"><span class="comment">    /*假设匹配到的文件为script/lib/jquery.js*/</span></span><br><span class="line">    .pipe(gulp.dest(<span class="string">'build'</span>)) <span class="comment">//此时生成的文件路径为 build/lib/jquery.js</span></span><br></pre></td></tr></table></figure><p>用<code>gulp.dest()</code>把文件流写入文件后，文件流仍然可以继续使用。</p><h4 id="gulp-task"><a href="#gulp-task" class="headerlink" title="gulp.task()"></a>gulp.task()</h4><p><code>gulp.task</code>方法用来定义任务，内部使用的是<code>Orchestrator</code>，其语法为：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gulp.task([name],[deps], fn)</span><br></pre></td></tr></table></figure><blockquote><p>name 为任务名。deps 是当前定义的任务需要依赖的其他任务，为一个数组。当前定义的任务会在所有依赖的任务执行完毕后才开始执行。如果没有依赖，则可省略这个参数。fn 为任务函数，我们把任务要执行的代码都写在里面。该参数也是可选的。</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">gulp.task(<span class="string">'mytask'</span>, [<span class="string">'array'</span>, <span class="string">'of'</span>, <span class="string">'task'</span>, <span class="string">'names'</span>], <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">//定义一个有依赖的任务</span></span><br><span class="line">  <span class="comment">// Do something</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p><code>gulp.task()</code>这个API没什么好讲的，但需要知道执行多个任务时怎么来控制任务执行的顺序。<br>gulp中执行多个任务，可以通过任务依赖来实现。例如我想要执行one,two,three这三个任务，那我们就可以定义一个空的任务，然后把那三个任务当做这个空的任务的依赖就行了：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//只要执行default任务，就相当于把one,two,three这三个任务执行了</span></span><br><span class="line">gulp.task(<span class="string">'default'</span>,[<span class="string">'one'</span>,<span class="string">'two'</span>,<span class="string">'three'</span>]);</span><br></pre></td></tr></table></figure><p>如果任务相互之间没有依赖，任务会按你书写的顺序来执行，如果有依赖的话则会先执行依赖的任务。但是如果某个任务所依赖的任务是异步的，就要注意了，gulp并不会等待那个所依赖的异步任务完成，而是会接着执行后续的任务。例如：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">gulp.task(<span class="string">'one'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="comment">//one是一个异步执行的任务</span></span><br><span class="line">  setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'one is done'</span>)</span><br><span class="line">  &#125;,<span class="number">5000</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//two任务虽然依赖于one任务,但并不会等到one任务中的异步操作完成后再执行</span></span><br><span class="line">gulp.task(<span class="string">'two'</span>,[<span class="string">'one'</span>],<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'two is done'</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>上面的例子中我们执行two任务时，会先执行one任务，但不会去等待one任务中的异步操作完成后再执行two任务，而是紧接着执行two任务。所以two任务会在one任务中的异步操作完成之前就执行了。</p><p>那如果我们想等待异步任务中的异步操作完成后再执行后续的任务，该怎么做呢？有三种方法可以实现:</p><p><em>第一: 在异步操作完成后执行一个回调函数来通知gulp这个异步任务已经完成,这个回调函数就是任务函数的第一个参数。</em></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">gulp.task(<span class="string">'one'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">cb</span>)</span>&#123; <span class="comment">//cb为任务函数提供的回调，用来通知任务已经完成</span></span><br><span class="line">  <span class="comment">//one是一个异步执行的任务</span></span><br><span class="line">  setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'one is done'</span>);</span><br><span class="line">    cb();  <span class="comment">//执行回调，表示这个异步任务已经完成</span></span><br><span class="line">  &#125;,<span class="number">5000</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//这时two任务会在one任务中的异步操作完成后再执行</span></span><br><span class="line">gulp.task(<span class="string">'two'</span>,[<span class="string">'one'</span>],<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'two is done'</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p><em>第二：定义任务时返回一个流对象。适用于任务就是操作gulp.src获取到的流的情况。(常用)</em></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">  var stream = gulp.src(&apos;client/**/*.js&apos;)</span><br><span class="line">      .pipe(dosomething()) //dosomething()中有某些异步操作</span><br><span class="line">      .pipe(gulp.dest(&apos;build&apos;));</span><br><span class="line">    return stream;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">gulp.task(&apos;two&apos;,[&apos;one&apos;],function()&#123;</span><br><span class="line">  console.log(&apos;two is done&apos;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p><em>第三：返回一个promise对象</em></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> Q = <span class="built_in">require</span>(<span class="string">'q'</span>); <span class="comment">//一个著名的异步处理的库 https://github.com/kriskowal/q</span></span><br><span class="line">gulp.task(<span class="string">'one'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">cb</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">var</span> deferred = Q.defer();</span><br><span class="line">  <span class="comment">// 做一些异步操作</span></span><br><span class="line">  setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">     deferred.resolve();</span><br><span class="line">  &#125;, <span class="number">5000</span>);</span><br><span class="line">  <span class="keyword">return</span> deferred.promise;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">gulp.task(<span class="string">'two'</span>,[<span class="string">'one'</span>],<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'two is done'</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p><code>gulp.task()</code>就这些了，主要是要知道当依赖是异步任务时的处理。</p><h4 id="gulp-watch"><a href="#gulp-watch" class="headerlink" title="gulp.watch()"></a>gulp.watch()</h4><p>监视文件的变化，当文件发生变化后，我们可以利用它来执行相应的任务，例如文件压缩等。其语法为：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gulp.watch([glob], [opts], [tasks])</span><br></pre></td></tr></table></figure><blockquote><p>glob 为要监视的文件匹配模式，规则和用法与gulp.src()方法中的glob相同。opts 为一个可选的配置对象，通常不需要用到。tasks 为文件变化后要执行的任务，为一个数组。</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">gulp.task(<span class="string">'uglify'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="comment">//do something</span></span><br><span class="line">&#125;);</span><br><span class="line">gulp.task(<span class="string">'reload'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="comment">//do something</span></span><br><span class="line">&#125;);</span><br><span class="line">gulp.watch(<span class="string">'js/**/*.js'</span>, [<span class="string">'uglify'</span>,<span class="string">'reload'</span>]);</span><br></pre></td></tr></table></figure><p>gulp.watch() 还有另外一种使用方式：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gulp.watch([glob], [opts], cb)</span><br></pre></td></tr></table></figure><blockquote><p>glob和opts参数与第一种用法相同。cb参数为一个函数。每当监视的文件发生变化时，就会调用这个函数,并且会给它传入一个对象，该对象包含了文件变化的一些信息，type属性为变化的类型，可以是<code>added,changed,deleted；path</code>属性为发生变化的文件的路径。</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">gulp.watch(<span class="string">'js/**/*.js'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">event</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(event.type); <span class="comment">//变化类型 added为新增,deleted为删除，changed为改变 </span></span><br><span class="line">    <span class="built_in">console</span>.log(event.path); <span class="comment">//变化的文件的路径</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>]]></content>
      
      <categories>
          
          <category> Web前端 </category>
          
          <category> 构建工具 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> web 自动化 构建工具 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>小程序如何引入fontAwesome</title>
      <link href="/2018/09/08/%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%A6%82%E4%BD%95%E5%BC%95%E5%85%A5fontAwesome/"/>
      <url>/2018/09/08/%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%A6%82%E4%BD%95%E5%BC%95%E5%85%A5fontAwesome/</url>
      <content type="html"><![CDATA[<blockquote><p>在开发小程序的时候, 一开始我所有的小图标都是直接在ps里面抠图下来, 然后使用image标签展示的, 后来组长给我提建议说, 能使用字体图标就更好了, 这样加载速度更快, 体验更加流畅, 那好吧, 既然组长都提了, 我也只能去查找资料小程序里面如果引入字体图标, 诶, 没想到还真可以! 那就引入吧!</p></blockquote><h3 id="1-先去Font-Awesome官网下载字体包"><a href="#1-先去Font-Awesome官网下载字体包" class="headerlink" title="1. 先去Font Awesome官网下载字体包"></a>1. 先去Font Awesome官网下载字体包</h3><p>官网链接: <a href="http://www.fontawesome.com.cn/" target="_blank" rel="noopener">Font Awesome中文官网</a></p><h3 id="2-打开下载的压缩包-找到-ttf文件"><a href="#2-打开下载的压缩包-找到-ttf文件" class="headerlink" title="2. 打开下载的压缩包, 找到.ttf文件"></a>2. 打开下载的压缩包, 找到.ttf文件</h3><p>如下图所示:<br><img src="/2018/09/08/小程序如何引入fontAwesome/fontAwesome 字体包.png" alt="fontAwesome 字体包"></p><h3 id="3-上传2中的字体文件到-https-transfonter-org-，选择-base64-编吗，convert后下载"><a href="#3-上传2中的字体文件到-https-transfonter-org-，选择-base64-编吗，convert后下载" class="headerlink" title="3. 上传2中的字体文件到 https://transfonter.org/，选择 base64 编吗，convert后下载"></a>3. 上传2中的字体文件到 <a href="https://transfonter.org/，选择" target="_blank" rel="noopener">https://transfonter.org/，选择</a> base64 编吗，convert后下载</h3><p>如下图所示:<br><img src="/2018/09/08/小程序如何引入fontAwesome/转换为base64.png" alt="转换为base64"></p><p>下一步 :<br><img src="/2018/09/08/小程序如何引入fontAwesome/下载转换之后的文件.png" alt="下载转换之后的文件"></p><h3 id="4-打开3中下载的文件，找到-stylesheet-css"><a href="#4-打开3中下载的文件，找到-stylesheet-css" class="headerlink" title="4. 打开3中下载的文件，找到 stylesheet.css"></a>4. 打开3中下载的文件，找到 stylesheet.css</h3><p>如下图所示:<br><img src="/2018/09/08/小程序如何引入fontAwesome/base64字体包.png" alt="base64字体包"></p><h3 id="5-复制里面的代码到微信小程序中的app-wxss中-或者新建一个-fontAwesome-wxss-文件"><a href="#5-复制里面的代码到微信小程序中的app-wxss中-或者新建一个-fontAwesome-wxss-文件" class="headerlink" title="5. 复制里面的代码到微信小程序中的app.wxss中, 或者新建一个 fontAwesome.wxss 文件"></a>5. 复制里面的代码到微信小程序中的app.wxss中, 或者新建一个 fontAwesome.wxss 文件</h3><p>stylesheet.css代码如下:<br><img src="/2018/09/08/小程序如何引入fontAwesome/stylesheet.png" alt="stylesheet"></p><p>复制到fontAwesome.wxss中:<br><img src="/2018/09/08/小程序如何引入fontAwesome/fontAwesome-wxss.png" alt="fontAwesome-wxss.png"></p><h3 id="6-打开1中的文件font-awesome-css-复制里面的css-去掉-font-face部分-到新建的fontAwesome-wxss文件中（接着6中复制内容的后面）"><a href="#6-打开1中的文件font-awesome-css-复制里面的css-去掉-font-face部分-到新建的fontAwesome-wxss文件中（接着6中复制内容的后面）" class="headerlink" title="6. 打开1中的文件font-awesome.css, 复制里面的css(去掉@font-face部分)到新建的fontAwesome.wxss文件中（接着6中复制内容的后面）"></a>6. 打开1中的文件font-awesome.css, 复制里面的css(去掉@font-face部分)到新建的fontAwesome.wxss文件中（接着6中复制内容的后面）</h3><p>font-awesome.css 文件位置 如下:<br><img src="/2018/09/08/小程序如何引入fontAwesome/文件目录.png" alt="文件目录.png"></p><p>打开文件:<br><img src="/2018/09/08/小程序如何引入fontAwesome/font-awesome-css.png" alt="font-awesome-css.png"></p><p>复制其余部分到fontAwesome.wxss<br><img src="/2018/09/08/小程序如何引入fontAwesome/copy到小程序的fontAwesome文件中.png" alt="copy到小程序的fontAwesome文件中.png"></p><h3 id="7-然后引入小程序中直接用就可以"><a href="#7-然后引入小程序中直接用就可以" class="headerlink" title="7. 然后引入小程序中直接用就可以"></a>7. 然后引入小程序中直接用就可以</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">'user-content'</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">navigator</span> <span class="attr">class</span>=<span class="string">'navigator'</span> <span class="attr">url</span>=<span class="string">"/pages/aboutUs/aboutUs"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">icon</span> <span class="attr">class</span>=<span class="string">"fa fa-user-circle-o fa-lg"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">'user-name'</span>&gt;</span>关于我们<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">image</span> <span class="attr">class</span>=<span class="string">'user-arrow'</span> <span class="attr">src</span>=<span class="string">'/images/arrow.png'</span> <span class="attr">mode</span>=<span class="string">'widthFix'</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">navigator</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">navigator</span> <span class="attr">class</span>=<span class="string">'navigator'</span> <span class="attr">url</span>=<span class="string">"/pages/favorite/favorite"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">icon</span> <span class="attr">class</span>=<span class="string">"fa fa-star fa-lg"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">'user-name'</span>&gt;</span>收藏夹<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">image</span> <span class="attr">class</span>=<span class="string">'user-arrow'</span> <span class="attr">src</span>=<span class="string">'/images/arrow.png'</span> <span class="attr">mode</span>=<span class="string">'widthFix'</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">navigator</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">'navigator'</span> <span class="attr">bindtap</span>=<span class="string">'focusPublic'</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">icon</span> <span class="attr">class</span>=<span class="string">"fa fa-heart fa-lg"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">'user-name'</span>&gt;</span>关注公众号<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">image</span> <span class="attr">class</span>=<span class="string">'user-arrow'</span> <span class="attr">src</span>=<span class="string">'/images/arrow.png'</span> <span class="attr">mode</span>=<span class="string">'widthFix'</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">'navigator last'</span> <span class="attr">bindtap</span>=<span class="string">'logout'</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">icon</span> <span class="attr">class</span>=<span class="string">"fa fa-sign-in fa-lg"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">'user-name'</span>&gt;</span>退出登录<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">image</span> <span class="attr">class</span>=<span class="string">'user-arrow'</span> <span class="attr">src</span>=<span class="string">'/images/arrow.png'</span> <span class="attr">mode</span>=<span class="string">'widthFix'</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure><p>效果图如下:<br><img src="/2018/09/08/小程序如何引入fontAwesome/效果图.png" alt="效果图.png"></p>]]></content>
      
      <categories>
          
          <category> Web前端 </category>
          
          <category> 小程序 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> web 小程序 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>小程序实现左滑删除功能</title>
      <link href="/2018/09/08/%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%AE%9E%E7%8E%B0%E5%B7%A6%E6%BB%91%E5%88%A0%E9%99%A4%E5%8A%9F%E8%83%BD/"/>
      <url>/2018/09/08/%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%AE%9E%E7%8E%B0%E5%B7%A6%E6%BB%91%E5%88%A0%E9%99%A4%E5%8A%9F%E8%83%BD/</url>
      <content type="html"><![CDATA[<blockquote><p>最近一直在开发微信小程序，无奈得实现开发的各种要求, 这不, 收藏夹的列表页需要添加一个左滑删除操作的功能, 于是在网上查阅了各种资料, 借鉴了大神们的一些思路, 好歹也能实现功能了吧, 这里就稍微记录一下, 就当作是自己的东西了吧, 哈哈 ^_^</p></blockquote><p>废话不多说, 先来看一下效果吧!!!</p><p><img src="/2018/09/08/小程序实现左滑删除功能/左滑删除.gif" alt=""></p><h3 id="wxml-结构"><a href="#wxml-结构" class="headerlink" title="wxml 结构"></a>wxml 结构</h3><ul><li>touch-item元素绑定了bindtouchstart、bindtouchmove事件</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">wx:for</span>=<span class="string">"&#123;&#123;patents&#125;&#125;"</span> <span class="attr">wx:key</span>=<span class="string">""</span> <span class="attr">class</span>=<span class="string">"touch-item &#123;&#123;item.isTouchMove ? 'touch-move-active' : ''&#125;&#125;"</span> <span class="attr">bindtouchstart</span>=<span class="string">"touchStart"</span> <span class="attr">bindtouchmove</span>=<span class="string">"touchMove"</span> <span class="attr">data-index</span>=<span class="string">"&#123;&#123;index&#125;&#125;"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"item"</span> &gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- ...其他代码 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"meta"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"title"</span>&gt;</span>&#123;&#123; item.title &#125;&#125;<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"apply"</span>&gt;</span>申请号: &#123;&#123; item.applicationNumber &#125;&#125;<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"apply"</span>&gt;</span>申请日: &#123;&#123; item.applicationDate &#125;&#125;<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"apply"</span>&gt;</span>公开号: &#123;&#123; item.publicNumber &#125;&#125;<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">'del'</span> <span class="attr">catchtap</span>=<span class="string">"delItem"</span> <span class="attr">data-index</span>=<span class="string">"&#123;&#123;index&#125;&#125;"</span>&gt;</span>删除<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="wxss-样式"><a href="#wxss-样式" class="headerlink" title="wxss 样式"></a>wxss 样式</h3><ul><li>flex布局、css3动画</li></ul><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 核心样式 */</span></span><br><span class="line"><span class="selector-class">.touch-item</span> <span class="selector-class">.item</span> &#123;</span><br><span class="line"><span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line"><span class="attribute">padding</span>: <span class="number">20</span>rpx;</span><br><span class="line"><span class="attribute">margin-right</span>:<span class="number">0</span>;</span><br><span class="line"><span class="attribute">-webkit-transition</span>: all <span class="number">0.4s</span>;</span><br><span class="line"><span class="attribute">transition</span>: all <span class="number">0.4s</span>;</span><br><span class="line"><span class="attribute">-webkit-transform</span>: <span class="built_in">translateX</span>(160rpx);</span><br><span class="line"><span class="attribute">transform</span>: <span class="built_in">translateX</span>(160rpx);</span><br><span class="line"><span class="attribute">margin-left</span>: -<span class="number">160</span>rpx</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.del</span> &#123;</span><br><span class="line"><span class="attribute">background-color</span>: orangered;</span><br><span class="line"><span class="attribute">font-size</span>: <span class="number">30</span>rpx;</span><br><span class="line"><span class="attribute">width</span>: <span class="number">160</span>rpx;</span><br><span class="line"><span class="attribute">display</span>: flex;</span><br><span class="line"><span class="attribute">flex-direction</span>: column;</span><br><span class="line"><span class="attribute">align-items</span>: center;</span><br><span class="line"><span class="attribute">justify-content</span>: center;</span><br><span class="line"><span class="attribute">color</span>: <span class="number">#fff</span>;</span><br><span class="line"><span class="attribute">-webkit-transform</span>: <span class="built_in">translateX</span>(160rpx);</span><br><span class="line"><span class="attribute">transform</span>: <span class="built_in">translateX</span>(160rpx);</span><br><span class="line"><span class="attribute">-webkit-transition</span>: all <span class="number">0.4s</span>;</span><br><span class="line"><span class="attribute">transition</span>: all <span class="number">0.4s</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.touch-move-active</span> <span class="selector-class">.item</span>,</span><br><span class="line"><span class="selector-class">.touch-move-active</span> <span class="selector-class">.del</span> &#123;</span><br><span class="line">  <span class="attribute">-webkit-transform</span>: <span class="built_in">translateX</span>(0);</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translateX</span>(0);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="js-交互"><a href="#js-交互" class="headerlink" title="js 交互"></a>js 交互</h3><ul><li>touchstart 和 touchmove 事件的处理</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 获取全局应用程序实例对象</span></span><br><span class="line"><span class="keyword">const</span> app = getApp()</span><br><span class="line"></span><br><span class="line">Page(&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 页面的初始数据</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  data: &#123;</span><br><span class="line">    showTopBtn: <span class="literal">false</span>,</span><br><span class="line">    total: <span class="number">0</span>,</span><br><span class="line">    hasMore: <span class="literal">true</span>,</span><br><span class="line">    page: <span class="number">1</span>,</span><br><span class="line">    size: <span class="number">20</span>,</span><br><span class="line">    patents: [],</span><br><span class="line">    startX: <span class="number">0</span>, <span class="comment">//开始坐标</span></span><br><span class="line">    startY: <span class="number">0</span></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 生命周期函数--监听页面加载</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  onLoad: <span class="function"><span class="keyword">function</span> (<span class="params">options</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 手指触摸动作开始 记录起点X坐标</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  touchStart(e) &#123;</span><br><span class="line">    <span class="comment">//开始触摸时 重置所有删除</span></span><br><span class="line">    <span class="keyword">this</span>.data.patents.forEach(<span class="function"><span class="keyword">function</span> (<span class="params">v, i</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">if</span> (v.isTouchMove) <span class="comment">//只操作为true的</span></span><br><span class="line">        v.isTouchMove = <span class="literal">false</span>;</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">this</span>.setData(&#123;</span><br><span class="line">      startX: e.changedTouches[<span class="number">0</span>].clientX,</span><br><span class="line">      startY: e.changedTouches[<span class="number">0</span>].clientY,</span><br><span class="line">      patents: <span class="keyword">this</span>.data.patents</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 手指滑动事件处理</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  touchMove(e) &#123;</span><br><span class="line">    <span class="keyword">var</span> that = <span class="keyword">this</span>,</span><br><span class="line">      index = e.currentTarget.dataset.index, <span class="comment">// 获取当前索引</span></span><br><span class="line">      startX = that.data.startX, <span class="comment">// 开始X坐标</span></span><br><span class="line">      startY = that.data.startY, <span class="comment">// 开始Y坐标</span></span><br><span class="line">      touchMoveX = e.changedTouches[<span class="number">0</span>].clientX, <span class="comment">// 滑动变化坐标</span></span><br><span class="line">      touchMoveY = e.changedTouches[<span class="number">0</span>].clientY; <span class="comment">// 滑动变化坐标</span></span><br><span class="line">    <span class="keyword">var</span> angle = that.getAngle(&#123; <span class="attr">X</span>: startX, <span class="attr">Y</span>: startY &#125;, &#123; <span class="attr">X</span>: touchMoveX, <span class="attr">Y</span>: touchMoveY &#125;); <span class="comment">// 获取滑动角度</span></span><br><span class="line"></span><br><span class="line">    that.data.patents.forEach(<span class="function"><span class="keyword">function</span> (<span class="params">v, i</span>) </span>&#123;</span><br><span class="line">      v.isTouchMove = <span class="literal">false</span>;</span><br><span class="line">      <span class="keyword">if</span> (<span class="built_in">Math</span>.abs(angle) &gt; <span class="number">30</span>) <span class="keyword">return</span>;  <span class="comment">//滑动超过30度角 return</span></span><br><span class="line">      <span class="keyword">if</span> (i == index &amp;&amp; touchMoveX &lt; startX) &#123; <span class="comment">// 左滑</span></span><br><span class="line">        v.isTouchMove = <span class="literal">true</span>;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123; <span class="comment">// 右滑</span></span><br><span class="line">        v.isTouchMove = <span class="literal">false</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="comment">//更新数据</span></span><br><span class="line">    that.setData(&#123;</span><br><span class="line">      patents: that.data.patents</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 删除事件</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  delItem(e) &#123;</span><br><span class="line">    <span class="keyword">var</span> that = <span class="keyword">this</span>;</span><br><span class="line">    <span class="comment">//获取列表中要删除项的下标</span></span><br><span class="line">    <span class="keyword">var</span> index = e.currentTarget.dataset.index;</span><br><span class="line">    <span class="keyword">this</span>.data.patents[index].isTouchMove = <span class="literal">true</span>;</span><br><span class="line">    <span class="comment">//更新数据</span></span><br><span class="line">    <span class="keyword">this</span>.setData(&#123;</span><br><span class="line">      patents: that.data.patents</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    wx.showModal(&#123;</span><br><span class="line">      title: <span class="string">'提示'</span>,</span><br><span class="line">      content: <span class="string">'确认是否删除？'</span>,</span><br><span class="line">      success: <span class="function"><span class="keyword">function</span> (<span class="params">res</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (res.confirm) &#123;</span><br><span class="line">          <span class="keyword">var</span> list = that.data.patents;</span><br><span class="line">          <span class="comment">//移除列表中下标为index的项</span></span><br><span class="line">          list.splice(index, <span class="number">1</span>);</span><br><span class="line">          <span class="comment">//更新列表的状态和缓存</span></span><br><span class="line">          that.setData(&#123;</span><br><span class="line">            patents: list,</span><br><span class="line">            total: list.length</span><br><span class="line">          &#125;);</span><br><span class="line">          wx.setStorageSync(<span class="string">'FAVORITE'</span>, list)</span><br><span class="line">          <span class="comment">// 重新写入用户文件</span></span><br><span class="line">          app.wechat.writeFile(<span class="string">'favorite.json'</span>, list)</span><br><span class="line"></span><br><span class="line">          wx.showToast(&#123;</span><br><span class="line">            title: <span class="string">'删除成功'</span>,</span><br><span class="line">            duration: <span class="number">1500</span></span><br><span class="line">          &#125;)</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="comment">// 取消则复原</span></span><br><span class="line">          that.data.patents[index].isTouchMove = <span class="literal">false</span>;</span><br><span class="line">          <span class="comment">//更新数据</span></span><br><span class="line">          that.setData(&#123;</span><br><span class="line">            patents: that.data.patents</span><br><span class="line">          &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 计算滑动角度</span></span><br><span class="line"><span class="comment">   * @param &#123;Object&#125; start 起点坐标</span></span><br><span class="line"><span class="comment">   * @param &#123;Object&#125; end 终点坐标</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  getAngle(start, end) &#123;</span><br><span class="line">    <span class="keyword">var</span> _X = end.X - start.X;</span><br><span class="line">    <span class="keyword">var</span> _Y = end.Y - start.Y;</span><br><span class="line">    <span class="comment">// 返回角度 /Math.atan()返回数字的反正切值</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">360</span> * <span class="built_in">Math</span>.atan(_Y / _X) / (<span class="number">2</span> * <span class="built_in">Math</span>.PI);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>]]></content>
      
      <categories>
          
          <category> Web前端 </category>
          
          <category> 小程序 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> web 小程序 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>小程序封装滚动Tab选项卡: 可滑动</title>
      <link href="/2018/09/08/%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%B0%81%E8%A3%85%E6%BB%9A%E5%8A%A8Tab%E9%80%89%E9%A1%B9%E5%8D%A1-%E5%8F%AF%E6%BB%91%E5%8A%A8/"/>
      <url>/2018/09/08/%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%B0%81%E8%A3%85%E6%BB%9A%E5%8A%A8Tab%E9%80%89%E9%A1%B9%E5%8D%A1-%E5%8F%AF%E6%BB%91%E5%8A%A8/</url>
      <content type="html"><![CDATA[<blockquote><p>在做公司小程序的过程当中需要用到tab的功能, 虽然小程序已经有了自带的tab选项组件, 直接在 app.json 文件里面配置即可使用, 奈何产品大大要求tab选项卡必须能够左右滑动还可以点击切换, 以便提高用户体验! 所以呢, 那就只能自己动手封装一个吧! </p></blockquote><p>最终的效果如下图所示: </p><p><img src="/2018/09/08/小程序封装滚动Tab选项卡-可滑动/tab选项卡.gif" alt=""></p><p>要求: </p><ul><li>1、tab内容区左右滑动切换时，tab标题随即做标记（active）。 </li><li>2、当active的标题不在当前屏显示时，要使其能显示到当前屏中。</li></ul><h3 id="wxml-结构"><a href="#wxml-结构" class="headerlink" title="wxml 结构"></a>wxml 结构</h3><ul><li>tab内容可左右滑动切换，使用swiper组件实现 </li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"tabview"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"tabs &#123;&#123;position == 'top'?'top':'bottom'&#125;&#125;"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">block</span> <span class="attr">wx:for</span>=<span class="string">"&#123;&#123;tabs&#125;&#125;"</span> <span class="attr">wx:key</span>=<span class="string">"index"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"tab-son &#123;&#123;activeIndex ==index?'active':''&#125;&#125;"</span> <span class="attr">data-index</span>=<span class="string">"&#123;&#123;index&#125;&#125;"</span> <span class="attr">bindtap</span>=<span class="string">'toggleTab'</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">image</span> <span class="attr">class</span>=<span class="string">'tab-icon'</span> <span class="attr">src</span>=<span class="string">'&#123;&#123;activeIndex ==index?item.selectedIcon:item.icon&#125;&#125;'</span> <span class="attr">mode</span>=<span class="string">'aspectFit'</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">'tab-text'</span>&gt;</span>&#123;&#123;item.name&#125;&#125;<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">block</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">swiper</span> <span class="attr">current</span>=<span class="string">"&#123;&#123;activeIndex&#125;&#125;"</span> <span class="attr">class</span>=<span class="string">"tab-swiper &#123;&#123;position == 'top'?'padding-top':'padding-bottom'&#125;&#125;"</span> <span class="attr">bindchange</span>=<span class="string">"swiperChange"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">swiper-item</span> <span class="attr">wx:for</span>=<span class="string">"&#123;&#123;tabs&#125;&#125;"</span> <span class="attr">wx:key</span>=<span class="string">"&#123;&#123;index&#125;&#125;"</span> <span class="attr">class</span>=<span class="string">"tab-contents"</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">slot</span> <span class="attr">name</span>=<span class="string">"&#123;&#123;index&#125;&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">swiper-item</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">swiper</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>说明: <ul><li>1、设置<code>data-index</code>属性用于：点击当前项时，通过点击事件<code>toggleTab</code>中处理 e.currentTarget.dataset.index 取到点击的目标值。 </li><li>2、swiper组件的<code>current</code>组件用于控制当前显示哪一页 </li><li>3、swiper组件绑定<code>change</code>事件swiperChange，通过e.currentTarget.dataset.index 拿到当前页</li></ul></li></ul><h3 id="wxss-样式部分"><a href="#wxss-样式部分" class="headerlink" title="wxss 样式部分"></a>wxss 样式部分</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.tabview</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>:<span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.tabs</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>:<span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">display</span>: flex; </span><br><span class="line">  <span class="attribute">position</span>:fixed;</span><br><span class="line">  <span class="attribute">left</span>:<span class="number">0</span>;</span><br><span class="line">  <span class="attribute">background-color</span>:<span class="number">#f8f8f8</span>;</span><br><span class="line">  <span class="attribute">height</span>:<span class="number">110</span>rpx;</span><br><span class="line">  <span class="attribute">font-size</span>:<span class="number">24</span>rpx;</span><br><span class="line">  <span class="attribute">z-index</span>:<span class="number">999</span>;</span><br><span class="line">  <span class="attribute">text-align</span>:center;</span><br><span class="line">  <span class="attribute">margin-top</span>: <span class="number">10</span>rpx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.tabs</span> <span class="selector-class">.active</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#7b58a7</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.top</span> &#123;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">box-shadow</span>:<span class="number">4px</span> <span class="number">4px</span> <span class="number">10px</span> <span class="number">#f2f2f2</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.bottom</span> &#123;</span><br><span class="line">  <span class="attribute">bottom</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">border-top</span>: <span class="number">1px</span> solid <span class="number">#d6d5d5</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.tab-son</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>:flex;</span><br><span class="line">  <span class="attribute">flex-direction</span>: column;</span><br><span class="line">  <span class="attribute">flex</span>: <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.tab-icon</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">64</span>rpx;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">50</span>rpx;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">12</span>rpx auto <span class="number">10</span>rpx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.tab-swiper</span> &#123;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.padding-top</span> &#123;</span><br><span class="line">  <span class="attribute">padding-top</span>: <span class="number">110</span>rpx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.padding-bottom</span> &#123;</span><br><span class="line">  <span class="attribute">padding-bottom</span>: <span class="number">110</span>rpx;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="js-部分"><a href="#js-部分" class="headerlink" title="js 部分"></a>js 部分</h3><ul><li>微信小程序在开发时个人感觉挺像vue的，以数据驱动视图的更新。但是在小程序中，不能直接操作dom，当然也不能使用jquery之类的库。</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// views/tabView.js</span></span><br><span class="line">Component(&#123;</span><br><span class="line">  <span class="comment">// 配置</span></span><br><span class="line">  options: &#123;</span><br><span class="line">    multipleSlots: <span class="literal">true</span> <span class="comment">//在组件定义时的选项中启用多slot支持</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 组件的属性列表</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  properties: &#123;</span><br><span class="line">    tabs: &#123;</span><br><span class="line">      type: <span class="built_in">Array</span>,</span><br><span class="line">      value: []</span><br><span class="line">    &#125;,</span><br><span class="line">    position: &#123;</span><br><span class="line">      type: <span class="built_in">String</span>,</span><br><span class="line">      value: <span class="string">'top'</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 组件的初始数据</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  data: &#123;</span><br><span class="line">    activeIndex: <span class="number">0</span></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 组件的方法列表</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  methods: &#123;</span><br><span class="line">    <span class="comment">// 点击切换tab</span></span><br><span class="line">    toggleTab: <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">this</span>.data.activeIndex === e.currentTarget.dataset.index) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">this</span>.setData(&#123;</span><br><span class="line">          activeIndex: e.currentTarget.dataset.index</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 滑动切换tab</span></span><br><span class="line">    swiperChange: <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">var</span> activeIndex = e.detail.current</span><br><span class="line">      <span class="keyword">this</span>.setData(&#123;</span><br><span class="line">        activeIndex</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>]]></content>
      
      <categories>
          
          <category> Web前端 </category>
          
          <category> 小程序 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> web 小程序 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>小程序出现【需要身份验证】弹窗解决办法</title>
      <link href="/2018/09/08/%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%87%BA%E7%8E%B0%E3%80%90%E9%9C%80%E8%A6%81%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%E3%80%91%E5%BC%B9%E7%AA%97%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95/"/>
      <url>/2018/09/08/%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%87%BA%E7%8E%B0%E3%80%90%E9%9C%80%E8%A6%81%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%E3%80%91%E5%BC%B9%E7%AA%97%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95/</url>
      <content type="html"><![CDATA[<blockquote><p>问题：在做微信小程序请求后端接口的时候，需要使用到<code>Authriation</code>进行授权，结果每次登录的时候都会出现这个弹窗。对<code>Authriation</code>不熟悉的，可以去阅读 <a href="http://www.ruanyifeng.com/blog/2014/05/oauth_2_0.html" target="_blank" rel="noopener">阮一峰-理解OAuth 2.0</a></p></blockquote><p><img src="/2018/09/08/小程序出现【需要身份验证】弹窗解决办法/需要进行身份验证.png" alt="需要进行身份验证"></p><h3 id="原因"><a href="#原因" class="headerlink" title="原因"></a>原因</h3><p>部分代码如下，按说使用了<code>Authriation</code>授权时，会将用户名和密码用 <a href="http://base64.xpcha.com/" target="_blank" rel="noopener">base64</a> 进行编码然后放到<code>header</code>中传入后端代码，就像 <font color="blue">‘Authorization’: ‘Basic V0VDSEFUOldFQ0hBVA=’</font>，在服务端也会有固定的用户名密码，与之比较，相同则身份通过，否则不通过才会出现上述这种弹窗。</p><h3 id="解决"><a href="#解决" class="headerlink" title="解决"></a>解决</h3><p>对用户名和密码进行 <a href="http://base64.xpcha.com/" target="_blank" rel="noopener">base64</a> 编码, 如下图:<br><img src="/2018/09/08/小程序出现【需要身份验证】弹窗解决办法/base64编码.png" alt="base64编码"></p><p>在输入框中输入用户名和密码，格式为：用户名:密码，比如<code>WECHAT:WECHAT</code>，也就是用户名是<code>WECHAT</code>，密码也是<code>WECHAT</code>。使用正确的编码之后，因为用户名和密码都正确，所以就不会再出现那种要求验证身份的对话框了</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">wx.request(&#123;</span><br><span class="line">      <span class="comment">// .....</span></span><br><span class="line">      data: &#123;</span><br><span class="line">        grant_type: <span class="string">'password'</span>,</span><br><span class="line">        username: user.username,</span><br><span class="line">        password: user.password</span><br><span class="line">      &#125;,</span><br><span class="line">      header: &#123;</span><br><span class="line">        <span class="string">'Authorization'</span>: <span class="string">'Basic V0VDSEFUOldFQ0hBVA='</span>,</span><br><span class="line">        <span class="string">'Content-Type'</span>: <span class="string">'application/x-www-form-urlencoded'</span></span><br><span class="line">      &#125;,        </span><br><span class="line">      success: <span class="function"><span class="keyword">function</span> (<span class="params">res</span>) </span>&#123;</span><br><span class="line">          <span class="comment">// ....  </span></span><br><span class="line">      &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h3><p>使用 base64 进行编码时，要注意不要多加了换行或者空格，得到的结果都是不一样的。</p><p>出现验证身份对话框的情景总结如下：</p><ul><li>用户名和密码错误；</li><li>用户名和密码正确，但是使用 base64 编码错误，常见情形：多加了换行符或者空格符。</li></ul>]]></content>
      
      <categories>
          
          <category> Web前端 </category>
          
          <category> 小程序 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> web 小程序 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Github如何进行PR(Pull Request)操作</title>
      <link href="/2018/07/24/Github%E5%A6%82%E4%BD%95%E8%BF%9B%E8%A1%8CPR(Pull%20Request)%E7%9A%84%E6%93%8D%E4%BD%9C/"/>
      <url>/2018/07/24/Github%E5%A6%82%E4%BD%95%E8%BF%9B%E8%A1%8CPR(Pull%20Request)%E7%9A%84%E6%93%8D%E4%BD%9C/</url>
      <content type="html"><![CDATA[<blockquote><p>最近参与了FreeCodeCamp社区的一个英文课程的翻译活动, 使用的平台就是github, 看了一下他们翻译的一些要求以及规范什么的, 需要涉及到github上的PR(Pull Request)操作。 本来是很简单的一个事情, 但是由于我所在的公司都没有使用过git来管理项目, 所以还是花了我一些时间去了解这个东西, 收获颇多, 在这里就分享一下吧!</p></blockquote><p>注: 这里为了叙述方便, 这里就以小明要与小红进行合作为例 , 小明需要对小红在GitHub上的的Repository进行fork等一系列的操作。 </p><h4 id="将小红在GitHub上的Repository-clone到小明的本地电脑"><a href="#将小红在GitHub上的Repository-clone到小明的本地电脑" class="headerlink" title="将小红在GitHub上的Repository clone到小明的本地电脑"></a>将小红在GitHub上的Repository clone到小明的本地电脑</h4><ul><li><p><strong>首先小明需要fork小红在GitHub上的Repository</strong></p><p>点击小红github上仓库的右侧Fork按钮,  此操作的作用是将小红在GitHub上的Repository复制到小明的GitHub，如下图: </p></li></ul><p><img src="/2018/07/24/Github如何进行PR(Pull Request)的操作/img01.png" alt=""></p><p>​    这时小明的GitHub上多了一个fork的Repository;  如下图：  </p><p><img src="/2018/07/24/Github如何进行PR(Pull Request)的操作/img02.png" alt=""></p><ul><li><p><strong>小明clone刚才Fork下来的Github Repository到自己的本地电脑</strong></p><p>打开刚才fork的Repository，复制该Repository的SSH地址然后输入命令, 这样就将项目clone到本地电脑上了</p><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="keyword">clone</span> <span class="title">xxx</span>(项目的地址)</span><br></pre></td></tr></table></figure></li></ul><h4 id="与小红在GitHub上的的Repository建立新的链接"><a href="#与小红在GitHub上的的Repository建立新的链接" class="headerlink" title="与小红在GitHub上的的Repository建立新的链接"></a>与小红在GitHub上的的Repository建立新的链接</h4><ul><li><p><strong>查看当前链接情况</strong></p><p>clone下来之后, 进入该项目的目录下面, 执行命令 git remote -v 就可以查看到当前仓库的链接情况</p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">cd</span> <span class="string">./challenges/</span></span><br><span class="line">git remove -v</span><br></pre></td></tr></table></figure><p>这时你会发现: 只与自己(也就是小明)的Repository 建立了链接，很显然没有与小红在GitHub上的Repository建立链接，如下图：</p><p><img src="/2018/07/24/Github如何进行PR(Pull Request)的操作/img03.png" alt=""></p></li><li><p><strong>与小红的GitHub上的Repository建立链接</strong></p><p>使用命令</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git remote <span class="built_in">add</span> upstream http<span class="variable">s:</span>//github.<span class="keyword">com</span>/timo1160139211/firstGit.git (原仓库的地址)</span><br></pre></td></tr></table></figure><p>与小红在GitHub上的Repository建立链接，<strong><em>注意此处的SSH为小红的GitHub上的Repository的SSH</em></strong>;  然后再查看一次, 如下图 :</p><p><img src="/2018/07/24/Github如何进行PR(Pull Request)的操作/img04.png" alt=""></p><p>如果小红的仓库(就是原仓库)有内容需要更新, 可以使用下面的命令pull到自己本地仓库</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">git</span> pull upstream xxxbranch（拉取上游仓库到本地仓库，保持文件一致。）</span><br></pre></td></tr></table></figure></li></ul><h4 id="修改文件提交-Commit"><a href="#修改文件提交-Commit" class="headerlink" title="修改文件提交 Commit"></a>修改文件提交 Commit</h4><ul><li><p><strong>新建工作分支</strong></p><p>使用命令 ( 新建并切换到新建的分支 xiaoming-branch )： </p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git checkout -<span class="selector-tag">b</span> xiaoming-branch</span><br></pre></td></tr></table></figure></li><li><p><strong>修改提交</strong></p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git <span class="keyword">add</span><span class="bash"> . （添加文件到暂存区</span></span><br><span class="line"><span class="bash">git commit -m <span class="string">'translate'</span>（提交修改到本地仓库）</span></span><br><span class="line"><span class="bash">git push（推送本地仓库到远程 GitHub 仓库）</span></span><br></pre></td></tr></table></figure></li></ul><h4 id="发起PR-Pull-Request"><a href="#发起PR-Pull-Request" class="headerlink" title="发起PR( Pull Request)"></a>发起PR( Pull Request)</h4><ul><li><p><strong>Comparing changes</strong></p><p>点击自己项目的 New pull request 按钮, 就会跳转到原仓库的地址项目, <strong>再点击New pull requests按钮</strong> </p></li></ul><p><img src="/2018/07/24/Github如何进行PR(Pull Request)的操作/img05.png" alt=""></p><ul><li><strong>进入 Comparing changes 页面</strong></li></ul><p><img src="/2018/07/24/Github如何进行PR(Pull Request)的操作/img06.png" alt=""></p><ul><li><p><strong>Create pull request</strong></p><p><img src="/2018/07/24/Github如何进行PR(Pull Request)的操作/img07.png" alt=""></p></li></ul><p><strong><em>提交PR之后, 最后 merge 就是小红的任务啦.</em></strong></p>]]></content>
      
      <categories>
          
          <category> Web前端 </category>
          
          <category> git </category>
          
      </categories>
      
      
        <tags>
            
            <tag> web </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>微信小程序简易开发</title>
      <link href="/2018/07/06/%E5%B0%8F%E7%A8%8B%E5%BA%8F%E7%AE%80%E6%98%93%E5%BC%80%E5%8F%91/"/>
      <url>/2018/07/06/%E5%B0%8F%E7%A8%8B%E5%BA%8F%E7%AE%80%E6%98%93%E5%BC%80%E5%8F%91/</url>
      <content type="html"><![CDATA[<blockquote><p>&emsp;&emsp;最近公司项目不是很赶, 所以平时还是有很多自由时间的, 刚好组长叫我做一个小程序的技术预研, 其实我以下所写的这些在微信官方文档上以及网上面都有详细说明的, 我这里只是做一个简化以及对我自己的学习小程序开发过程的一个记录。</p></blockquote><h2 id="开发准备"><a href="#开发准备" class="headerlink" title="开发准备"></a>开发准备</h2><blockquote><p>在开始小程序开发之前需要去官网注册一个appleID, 然后还需要下载小程序开发工具, 这些都比较简单, 这里就不累述了.  </p></blockquote><p>小程序注册链接: <a href="https://developers.weixin.qq.com/miniprogram/dev/" target="_blank" rel="noopener">https://developers.weixin.qq.com/miniprogram/dev/</a></p><h3 id="创建项目"><a href="#创建项目" class="headerlink" title="创建项目"></a>创建项目</h3><p>官方的开发工具准备了一个<code>QuickStart</code>项目。在创建时，如果选择空文件夹，开发者工具会提示：是否需要创建一个<code>QuickStart</code>项目。选择是，开发者工具会自动帮助我们在开发目录里生成一个简单的项目。</p><p><img src="/2018/07/06/小程序简易开发/sm_pic1.png" alt=""></p><h3 id="项目结构"><a href="#项目结构" class="headerlink" title="项目结构"></a>项目结构</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">└─ Demo/ ······················· 项目所在目录</span><br><span class="line">   ├─ pages/ ··························· 页面目录</span><br><span class="line">   │  ├─ index/ ························  index页面</span><br><span class="line">   │  │  ├─ index<span class="selector-class">.js</span> ···················   index页面逻辑</span><br><span class="line">   │  │  ├─ index<span class="selector-class">.wxml</span> ·················   index页面结构</span><br><span class="line">   │  │  └─ index<span class="selector-class">.wxss</span> ·················   index页面样式</span><br><span class="line">   │  └─ logs/ ·························  logs页面</span><br><span class="line">   │     ├─ logs<span class="selector-class">.js</span> ····················   logs页面逻辑</span><br><span class="line">   │     ├─ logs<span class="selector-class">.wxml</span> ··················   logs页面结构</span><br><span class="line">   │     └─ logs<span class="selector-class">.wxss</span> ··················   logs页面样式</span><br><span class="line">   ├─ utils/ ···························  公共脚本目录</span><br><span class="line">   │  └─ util<span class="selector-class">.js</span> ·······················   工具脚本</span><br><span class="line">   ├─ app<span class="selector-class">.js</span> ··························· 应用程序逻辑</span><br><span class="line">   ├─ app<span class="selector-class">.json</span> ························· 应用程序配置</span><br><span class="line">   └─ app<span class="selector-class">.wxss</span> ························· 应用程序公共样式</span><br></pre></td></tr></table></figure><h3 id="页面结构"><a href="#页面结构" class="headerlink" title="页面结构"></a>页面结构</h3><p>每个页面组件也分为四个文件组成:</p><ul><li><strong>[page-name].js</strong> <ul><li>页面逻辑文件，用于创建页面对象，以及处理页面生命周期控制和数据处理</li></ul></li><li><strong>[page-name].json</strong> : <ul><li>设置当前页面工作时的window的配置，此处会覆盖app.json中的window设置，也就是说只可以设置window中设置的属性 </li></ul></li><li><strong>[page-name].wxml</strong> :  <ul><li>wxml指的是Wei Xin Markup Language </li><li>用于定义页面中元素结构的，语法遵循XML语法，注意是XML语法，不是HTML语法 </li></ul></li><li><strong>[page-name].wxss</strong><ul><li>wxml指的是Wei Xin Style Sheet </li><li>用于定义页面样式的，语法遵循CSS语法，扩展了CSS基本用法和长度单位（主要就是rpx响应式像素） </li></ul></li></ul><h3 id="项目配置"><a href="#项目配置" class="headerlink" title="项目配置"></a>项目配置</h3><p><img src="/2018/07/06/小程序简易开发/config.jpg" alt="config"></p><p>小程序的配置文件分为两种: </p><ul><li>全局配置文件, 根目录下的 <code>app.json</code></li><li>页面配置文件, 每个页面目录下的<code>[page-name].json</code></li></ul><p><em><strong>app.json</strong></em>  —&gt;  项目配置声明文件 (指定项目的一些信息，比如导航栏样式颜色等等 )</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="comment">// 当前程序是由哪些页面组成的（第一项默认为初始页面）所有使用到的组件或页面都必须在此体现</span></span><br><span class="line">  <span class="string">"pages"</span>: [ ... ],</span><br><span class="line">  <span class="comment">// 应用程序窗口设置</span></span><br><span class="line">  <span class="string">"window"</span>: &#123; ... &#125;,</span><br><span class="line">  <span class="comment">// 应用导航栏设置</span></span><br><span class="line">  <span class="string">"tabBar"</span>: &#123; ... &#125;,</span><br><span class="line">  <span class="comment">// 网络超时设置</span></span><br><span class="line">  <span class="string">"networkTimeout"</span>: &#123;&#125;,</span><br><span class="line">  <span class="comment">// 是否在控制台输出调试信息</span></span><br><span class="line">  <span class="string">"debug"</span>: <span class="literal">true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><em><strong>[page-name].json</strong></em>  —&gt;  用于指定特定页面工作时，window的设置： </p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="comment">// 导航条背景色</span></span><br><span class="line">  <span class="string">"navigationBarBackgroundColor"</span>: <span class="string">"#35495e"</span>,</span><br><span class="line">  <span class="comment">// 导航条前景色（只能是white/black）</span></span><br><span class="line">  <span class="string">"navigationBarTextStyle"</span>: <span class="string">"white"</span>,</span><br><span class="line">  <span class="comment">// 导航条文本</span></span><br><span class="line">  <span class="string">"navigationBarTitleText"</span>: <span class="string">"电影 « 豆瓣"</span>,</span><br><span class="line">  <span class="comment">// 窗口背景颜色</span></span><br><span class="line">  <span class="string">"backgroundColor"</span>: <span class="string">"#fff"</span>,</span><br><span class="line">  <span class="comment">// 窗口前景色</span></span><br><span class="line">  <span class="string">"backgroundTextStyle"</span>: <span class="string">"dark"</span>,</span><br><span class="line">  <span class="comment">// 是否开启下拉刷新</span></span><br><span class="line">  <span class="string">"enablePullDownRefresh"</span>: <span class="literal">true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="逻辑层分析"><a href="#逻辑层分析" class="headerlink" title="逻辑层分析"></a>逻辑层分析</h3><h4 id="应用程序逻辑-app-js"><a href="#应用程序逻辑-app-js" class="headerlink" title="应用程序逻辑 app.js"></a>应用程序逻辑 <code>app.js</code></h4><p><code>app.js</code>作为项目主入口文件，用于创建应用程序对象 </p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// App函数是一个全局函数，用于创建应用程序对象</span></span><br><span class="line">App(&#123;</span><br><span class="line">  <span class="comment">// ========== 全局数据对象（可以整个应用程序共享） ==========</span></span><br><span class="line">  globalData: &#123; ... &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ========== 应用程序全局方法 ==========</span></span><br><span class="line">  method1 (p1, p2) &#123; ... &#125;,</span><br><span class="line">  method2 (p1, p2) &#123; ... &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ========== 生命周期方法 ==========</span></span><br><span class="line">  <span class="comment">// 应用程序启动时触发一次</span></span><br><span class="line">  onLaunch () &#123; ... &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 当应用程序进入前台显示状态时触发</span></span><br><span class="line">  onShow () &#123; ... &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 当应用程序进入后台状态时触发</span></span><br><span class="line">  onHide () &#123; ... &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>也就是说，当应用程序启动时会自动执行项目目录下的<code>app.js</code>文件。</p><p>在<code>app.js</code>中通过调用全局<code>App([option])</code>方法创建一个应用程序实例。</p><p>其中通过参数指定的一些特定的方法，会在特定的执行时机去执行，也就是说通常所说的生命周期事件方法。 </p><table><thead><tr><th style="text-align:center">属性</th><th style="text-align:center">类型</th><th>描述</th><th>触发时机</th></tr></thead><tbody><tr><td style="text-align:center">onLaunch</td><td style="text-align:center">Function</td><td>生命周期函数–监听小程序初始化</td><td>当小程序初始化完成时，会触发 onLaunch（全局只触发一次）</td></tr><tr><td style="text-align:center">onShow</td><td style="text-align:center">Function</td><td>生命周期函数–监听小程序显示</td><td>当小程序启动，或从后台进入前台显示，会触发 onShow</td></tr><tr><td style="text-align:center">onHide</td><td style="text-align:center">Function</td><td>生命周期函数–监听小程序隐藏</td><td>当小程序从前台进入后台，会触发 onHide</td></tr></tbody></table><p>也可以定义任意其他的对象成员（例如：方法和属性），这些成员可以在内部直接使用，或者外部通过获取<code>app</code>对象调用： </p><table><thead><tr><th>属性</th><th>类型</th><th>描述</th></tr></thead><tbody><tr><td>其他</td><td>Any</td><td>开发者可以添加任意的函数或数据到 Object 参数中，用 this 可以访问，一般用于存放业务逻辑配置，比如：API地址</td></tr></tbody></table><p>app.js </p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">App(&#123;</span><br><span class="line">  data1: <span class="string">'123'</span>,</span><br><span class="line">  data2: &#123; <span class="attr">message</span>: <span class="string">'hello world'</span> &#125;,</span><br><span class="line">  api: &#123;</span><br><span class="line">    list: <span class="string">'https://github.com/zce/'</span>,</span><br><span class="line">    detail: <span class="string">'https://github.com/zce/'</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  foo () &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">'bar'</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>other.js</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// getApp 也是全局函数，可以在任意地方调用，用于获取全局应用程序实例对象</span></span><br><span class="line"><span class="keyword">var</span> app = getApp();</span><br><span class="line"><span class="built_in">console</span>.log(app.data1);</span><br><span class="line"><span class="built_in">console</span>.log(app.data2);</span><br><span class="line"><span class="built_in">console</span>.log(app.foo());</span><br></pre></td></tr></table></figure><h4 id="页面逻辑-page-name-js"><a href="#页面逻辑-page-name-js" class="headerlink" title="页面逻辑[page-name].js"></a>页面逻辑<code>[page-name].js</code></h4><p><code>[page-name].js</code>是一个页面的重要组成部分，用于创建页面对象 </p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 获取全局应用程序对象</span></span><br><span class="line"><span class="keyword">const</span> app = getApp()</span><br><span class="line"></span><br><span class="line"><span class="comment">// Page也是一个全局函数，用来创建页面对象</span></span><br><span class="line">Page(&#123;</span><br><span class="line">  <span class="comment">// ========== 页面数据对象（可以暴露到视图中，完成数据绑定） ==========</span></span><br><span class="line">  data: &#123; ... &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ========== 页面方法（可以用于抽象一些公共的行为，例如加载数据，也可以用于定义事件处理函数） ==========</span></span><br><span class="line">  method1 (p1, p2) &#123; ... &#125;,</span><br><span class="line">  method2 (p1, p2) &#123; ... &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ========== 生命周期方法 ==========</span></span><br><span class="line">  <span class="comment">// 页面加载触发</span></span><br><span class="line">  onLoad () &#123; ... &#125;</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>在应用程序执行到当前页面时，会执行当前页面下对应的<code>[page-name].js</code>文件。 在<code>[page-name].js</code>中通过调用全局<code>Page([option])</code>方法创建一个页面实例。</p><h5 id="Page-option-方法-option-参数说明"><a href="#Page-option-方法-option-参数说明" class="headerlink" title="Page([option])方法[option]参数说明"></a><code>Page([option])</code>方法<code>[option]</code>参数说明</h5><table><thead><tr><th>属性</th><th>类型</th><th>描述</th></tr></thead><tbody><tr><td>data</td><td>Object</td><td>页面的初始数据</td></tr><tr><td>onLoad</td><td>Function</td><td>生命周期函数–监听页面加载</td></tr><tr><td>onReady</td><td>Function</td><td>生命周期函数–监听页面初次渲染完成</td></tr><tr><td>onShow</td><td>Function</td><td>生命周期函数–监听页面显示</td></tr><tr><td>onHide</td><td>Function</td><td>生命周期函数–监听页面隐藏</td></tr><tr><td>onUnload</td><td>Function</td><td>生命周期函数–监听页面卸载</td></tr><tr><td>onPullDownRefreash</td><td>Function</td><td>页面相关事件处理函数–监听用户下拉动作</td></tr><tr><td>其他</td><td>Any</td><td>开发者可以添加任意的函数或数据到 object 参数中，用 this 可以访问</td></tr></tbody></table><h3 id="视图层分析"><a href="#视图层分析" class="headerlink" title="视图层分析"></a>视图层分析</h3><h4 id="page-name-wxml页面结构"><a href="#page-name-wxml页面结构" class="headerlink" title="[page-name].wxml页面结构"></a><code>[page-name].wxml</code>页面结构</h4><p><code>WXML（WeiXin Markup Language）</code>是<code>MINA框架</code>设计的一套标签语言，基于<code>XML</code>。</p><p>结合一些基础组件、事件系统、模板数据绑定，可以构建出页面的结构。</p><p>简单来说：wxml ≈ xml + 事件系统 + 模板引擎</p><p>例如：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// js</span></span><br><span class="line">Page(&#123;</span><br><span class="line">  data: &#123;</span><br><span class="line">    todos: [</span><br><span class="line">      &#123; <span class="attr">text</span>: <span class="string">'JavaScript'</span>, <span class="attr">completed</span>: <span class="literal">false</span> &#125;,</span><br><span class="line">      &#123; <span class="attr">text</span>: <span class="string">'JavaScript+'</span>, <span class="attr">completed</span>: <span class="literal">false</span> &#125;,</span><br><span class="line">      &#123; <span class="attr">text</span>: <span class="string">'JavaScript++'</span>, <span class="attr">completed</span>: <span class="literal">false</span> &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  completed (e) &#123; ... &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- wxml --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">view</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">view</span> <span class="attr">wx:for</span>=<span class="string">"&#123;&#123; todos &#125;&#125;"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">block</span> <span class="attr">wx:if</span>=<span class="string">"&#123;&#123; !item.completed &#125;&#125;"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">text</span>&gt;</span>&#123;&#123; item.text &#125;&#125;<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">bindtap</span>=<span class="string">"completed"</span> <span class="attr">data-item-index</span>=<span class="string">"&#123;&#123; index &#125;&#125;"</span>&gt;</span> √ <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">block</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="page-name-wxss页面样式"><a href="#page-name-wxss页面样式" class="headerlink" title="[page-name].wxss页面样式"></a><code>[page-name].wxss</code>页面样式</h4><p><code>WXSS（WeiXin Style Sheets）</code>是<code>MINA框架</code>设计的一套标签语言，基于<code>XML</code>。</p><p><code>WXSS</code>用来决定了在<code>WXML</code>中定义的组件应该怎么显示。</p><p>为了适应广大的前端开发者，我们的<code>WXSS</code>具有<code>CSS</code>大部分特性。 同时为了更适合开发微信小程序，我们对<code>CSS</code>进行了扩充以及修改。扩展的特性有: </p><h5 id="尺寸单位"><a href="#尺寸单位" class="headerlink" title="尺寸单位"></a>尺寸单位</h5><p>rpx（responsive pixel）: 可以根据屏幕宽度进行自适应。规定屏幕宽为750rpx。如在 iPhone6 上，屏幕宽度为375px，共有750个物理像素，则750rpx = 375px = 750物理像素，1rpx = 0.5px = 1物理像素。</p><p>rem（root em）: 规定屏幕宽度为20rem；1rem = (750/20)rpx 。</p><table><thead><tr><th>设备</th><th>rpx换算px (屏幕宽度/750)</th><th>px换算rpx (750/屏幕宽度)</th><th>rem换算rpx (750/20)</th></tr></thead><tbody><tr><td>iPhone5</td><td>1rpx = 0.42px</td><td>1px = 2.34rpx</td><td>1rem = 37.5rpx</td></tr><tr><td>iPhone6</td><td>1rpx = 0.5px</td><td>1px = 2rpx</td><td>1rem = 37.5rpx</td></tr><tr><td>iPhone6s</td><td>1rpx = 0.552px</td><td>1px = 1.81rpx</td><td>1rem = 37.5rpx</td></tr></tbody></table><blockquote><ul><li><strong>建议：</strong> 开发微信小程序时设计师可以用 iPhone6 作为视觉稿的标准。</li><li><strong>注意：</strong> 在较小的屏幕上不可避免的会有一些毛刺，请在开发时尽量避免这种情况。</li></ul></blockquote><h5 id="样式导入"><a href="#样式导入" class="headerlink" title="样式导入"></a>样式导入</h5><p>使用<code>@import</code>语句可以导入外联样式表，<code>@import</code>后跟需要导入的外联样式表的相对路径，用<code>;</code>表示语句结束。</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">@<span class="keyword">import</span> <span class="string">"common.wxss"</span>;</span><br><span class="line"><span class="selector-tag">text</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#ff0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="选择器"><a href="#选择器" class="headerlink" title="选择器"></a>选择器</h5><p>目前只支持如下选择器</p><table><thead><tr><th>选择器</th><th>样例</th><th>样例描述</th></tr></thead><tbody><tr><td>.class</td><td>.intro</td><td>选择所有拥有 class=”intro” 的组件</td></tr><tr><td>#id</td><td>#firstname</td><td>选择拥有 id=”firstname” 的组件</td></tr><tr><td>element</td><td>view</td><td>选择所有 view 组件</td></tr><tr><td>element, element</td><td>view</td><td>checkbox 选择所有文档的 view 组件和所有的 checkbox 组件</td></tr><tr><td>::after</td><td>view::after</td><td>在 view 组件后边插入内容</td></tr><tr><td>::before</td><td>view::before</td><td>在 view 组件前边插入内容</td></tr></tbody></table><h5 id="全局样式与局部样式"><a href="#全局样式与局部样式" class="headerlink" title="全局样式与局部样式"></a>全局样式与局部样式</h5><p>定义在<code>app.wxss</code>中的样式为全局样式，作用于每一个页面。在<code>[page-name].wxss</code>文件中定义的样式为局部样式，只作用在对应的页面，并会覆盖<code>app.wxss</code>中相同的选择器。</p>]]></content>
      
      <categories>
          
          <category> Web前端 </category>
          
          <category> 小程序 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> web 小程序 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Javascript 设计模式(二) --- 构造器模式与模块模式</title>
      <link href="/2018/06/20/Javascript%20%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F(%E4%BA%8C)/"/>
      <url>/2018/06/20/Javascript%20%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F(%E4%BA%8C)/</url>
      <content type="html"><![CDATA[<blockquote><p>&emsp;&emsp;继续上一篇设计模式的学习笔记记录</p></blockquote><!-- ### Observer (观察者) 模式  -- 有待深究 --><!-- ### Mediator (中介者) 模式 --><h3 id="Prototype-原型-模式"><a href="#Prototype-原型-模式" class="headerlink" title="Prototype (原型) 模式"></a>Prototype (原型) 模式</h3>]]></content>
      
      <categories>
          
          <category> Web前端 </category>
          
          <category> Javascript </category>
          
          <category> 设计模式 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 设计模式 Js </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>10分钟解读 Javascript 的Async/Await</title>
      <link href="/2018/05/06/10%E5%88%86%E9%92%9F%E8%A7%A3%E8%AF%BB%20Javascript%20%E7%9A%84Async-Await/"/>
      <url>/2018/05/06/10%E5%88%86%E9%92%9F%E8%A7%A3%E8%AF%BB%20Javascript%20%E7%9A%84Async-Await/</url>
      <content type="html"><![CDATA[<p>原文链接<a href="https://tutorialzine.com/2017/07/javascript-async-await-explained" target="_blank" rel="noopener">https://tutorialzine.com/2017/07/javascript-async-await-explained</a></p><blockquote><p>长期以来，javascript开发者们都必须依赖回调函数来处理异步请求代码。结果就是当我们遇到类似下面的方法时，很多人都会经历的回调地狱。（下面是一段代码，这里省略，可以直接看链接）</p></blockquote><blockquote><p>幸运的是， 随着ES6的发布，我们有了Promise里面的then（或者称为.then()）来处理异步回调，他们提供了很多处理回调的可供选择的方法，而且很多社区快速的运用了他们来替代原来的代码。</p></blockquote><blockquote><p>现在随着最近Async/Await的加入， Javascript将会越来越容易开发。</p></blockquote><h3 id="什么是-Async-Await"><a href="#什么是-Async-Await" class="headerlink" title="什么是 Async/Await?"></a>什么是 Async/Await?</h3><blockquote><p>Async/Await是我们长久一来一直期盼的javascript的一个特性， 它可以让我们在异步函数处理上更加便捷方便而且也易于理解，它是建立在Promise的基础上，而且也是可以兼容所有Promise的常用API。</p></blockquote><blockquote><p>Async/Await这个名字是来自<strong>async</strong>和<strong>await-</strong>这两个关键字, 可以帮助我们理清异步代码:</p></blockquote><h4 id="Async-声明了一个异步函数-async-function-someName"><a href="#Async-声明了一个异步函数-async-function-someName" class="headerlink" title="Async - 声明了一个异步函数(async function someName(){...})"></a>Async - 声明了一个异步函数(<code>async function someName(){...}</code>)</h4><ul><li>在Promise里面自动的转换为一个个常规的函数</li><li>在函数内部return的时候就可以调用异步函数解决</li><li>这是异步函数就可以使用await了</li></ul><h4 id="Awaut-暂停异步函数的执行-var-result-await-someAsyncCall"><a href="#Awaut-暂停异步函数的执行-var-result-await-someAsyncCall" class="headerlink" title="Awaut - 暂停异步函数的执行(var result = await someAsyncCall();)"></a>Awaut - 暂停异步函数的执行(<code>var result = await someAsyncCall();</code>)</h4><ul><li>运用在Promise回调之前，await会强制代码停止运行直到Promise请求完成并返回结果才会继续代码执行</li><li>Await只能与Promise一同使用，在回调函数里面是不起作用的</li><li>Await可以单独用在异步函数里面</li></ul><p>下面有一个简单的例子可以帮助我们理解:</p><p>&emsp;例如我们想从服务器获取一个JSON文件, 我们可以写一个函数使用<strong>axios</strong>(这里用axios来发送请求)数据库来发送一个HTTP的get请求地址<strong><a href="https://tutorialzine.com/misc/files/example.json" target="_blank" rel="noopener">https://tutorialzine.com/misc/files/example.json</a></strong>。发送请求之后必须等待服务器响应，这样的请求就是一个HTTP的异步请求。</p><p>&emsp;下面我们用两种方法来实现，第一种用Promise， 第二钟使用Async/Await</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Promise 方法</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getJSOn</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">//创建一个Promise对象</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve</span>) </span>&#123;</span><br><span class="line">        axios.get(<span class="string">'https://tutorialzine.com/misc/files/example.json'</span>)</span><br><span class="line">            .then(<span class="function"><span class="keyword">function</span> (<span class="params">json</span>) </span>&#123;</span><br><span class="line">                <span class="comment">//使用resolve返回结果</span></span><br><span class="line">                resolve(json);</span><br><span class="line">            &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Async/Await 方法</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//async关键字会自动创建一个Promise对象并返回</span></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">getJSONAsync</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">//await关键字帮我们处理了并不需要then方法</span></span><br><span class="line">    <span class="keyword">let</span> json = <span class="keyword">await</span> axios.get(<span class="string">'https://tutorialzine.com/misc/files/example.json'</span>);</span><br><span class="line">    <span class="comment">//直接返回类似于同步函数</span></span><br><span class="line">    <span class="keyword">return</span> json;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;很明显我们可以看到使用Async/Await版本的代码更简洁也更容易阅读，除了语法不同，其实两个函数是一样的，他们都返回了一个Promise对象和接收了从axios响应过来的JSON数据， 所以异步函数还可以写成这样的：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">getJSONAsync().then(<span class="function"><span class="keyword">function</span>(<span class="params">result</span>)</span>&#123;</span><br><span class="line">    <span class="comment">//DO something with result</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="Async-Await会创建之前那样的promise吗"><a href="#Async-Await会创建之前那样的promise吗" class="headerlink" title="Async/Await会创建之前那样的promise吗?"></a>Async/Await会创建之前那样的promise吗?</h3><p> &emsp;并不全是，当你使用Async/Await时在底层来说还是会使用到Promise，所以如果你对Promise有了一定的理解之后会有很大的帮助，也是我们所推荐的。</p><p> &emsp;甚至在一些案例当中，如果使用Async/Await不能满足我们要求时，还是会回过头来请求Promise的帮助。其中的一个使用场景就是当我们需要同时等待很多独立的异步回调完成执行。</p><p> &emsp;下面的例子就是这样:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">getABC</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> A = <span class="keyword">await</span> getValueA(); <span class="comment">// getValueA 2秒完成</span></span><br><span class="line">  <span class="keyword">let</span> B = <span class="keyword">await</span> getValueB(); <span class="comment">// getValueB 4秒完成</span></span><br><span class="line">  <span class="keyword">let</span> C = <span class="keyword">await</span> getValueC(); <span class="comment">// getValueC 3秒完成</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> A*B*C;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;每一个await的回调都会等待前一个回调返回结果才会执行，所以如果我们一次性请求的话，这整个函数从开始到结束总共需要花费9秒钟（2+4+3)。</p><p>&emsp;当这三个顺序可变的并不彼此依赖的函数，这并不是最好的解决方法。换句话说，我们不需要知道A是否需要在B的前面获取，而是可以同时获取到三个的值，而尽量用最少的时间等待。</p><p>&emsp;所以我们就可以使用Promise.all()在同一个时间发生的所有的请求，并且可以确保在往下执行代码之前可以获取到所有的返回值，因为它会让所有的回调函数可以并行发送请求，而不是一个接一个。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">getABC</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 同时请求所有的函数</span></span><br><span class="line">  <span class="keyword">let</span> results = <span class="keyword">await</span> <span class="built_in">Promise</span>.all([ getValueA, getValueB, getValueC ]);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> results.reduce(<span class="function">(<span class="params">total,value</span>) =&gt;</span> total * value);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;这种方法就可以花更少的时间，getValueA 和 getValueC这两个函数在 getValueB完成的时候早就结束了，所以整个函数运行的时间就是最慢的那个请求的时间，有效了减小了总时间。</p><h3 id="Async-Await处理错误"><a href="#Async-Await处理错误" class="headerlink" title="Async/Await处理错误"></a>Async/Await处理错误</h3><p>&emsp;使用Async/Await的另一个好处就是允许我们在try/catch里面获取到任务不可预期的报错，只需要将await回调包起来即可：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">doSomethingAsync</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// 这个请求有可能会失败</span></span><br><span class="line">        <span class="keyword">let</span> result = <span class="keyword">await</span> someAsyncCall();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span>(error) &#123;</span><br><span class="line">        <span class="comment">// 这里就是获取到的报错信息</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;catch语句会处理从等待异步回调或者任何其他我们写在try语句里面有可能会失败的代码所引发的报错。</p><p>&emsp;如果情景需要的话，我们也可以从async函数里面抓取到报错，因为所有的async函数都返回一个Promise对象，这样我们就可以很简单的使用.catch()事件来处理我们的回调函数。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 不使用try catch语句</span></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">doSomethingAsync</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="comment">// 异步函数有可能会失败</span></span><br><span class="line">    <span class="keyword">let</span> result = <span class="keyword">await</span> someAsyncCall();</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 调用函数的时候来处理报错</span></span><br><span class="line">doSomethingAsync().</span><br><span class="line">    .then(successHandler)</span><br><span class="line">    .catch(errorHandler);</span><br></pre></td></tr></table></figure><p>&emsp;你更喜欢并且坚持使用哪个方法来处理报错是很重要的，同时使用try/catch语句和.catch()会尽可能的定位到问题所在。</p><h3 id="浏览器支持"><a href="#浏览器支持" class="headerlink" title="浏览器支持"></a>浏览器支持</h3><p>&emsp;Async/Await在大部分主流浏览器上都是支持的，但是IE所有的版本（包括IE11）都不兼容在没有使用外部的库之类的话。</p><p>&emsp;Node开发者们也可以在Node8及以上的版本上体验到async的好处，近两年将会应用于LTS版本。</p><p>&emsp;如果这篇文章并不能让你理解，这里还有几篇JS的文章like<a href="https://babeljs.io/docs/plugins/transform-async-to-generator/" title="Babel" target="_blank" rel="noopener">Babel</a> 和 <a href="https://www.typescriptlang.org/docs/handbook/release-notes/typescript-2-3.html" title="TypeScipt" target="_blank" rel="noopener">TypeScript</a>，而且在node.js里面还提供了他们自己的跨平台版本供我们学习 <a href="https://github.com/yortus/asyncawait" title="asyncawait" target="_blank" rel="noopener">asyncawait</a>。</p><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><blockquote><p>随着Async/Await的出现，javascript语言在代码的可读性以及使用简单的方面上提升了一个很大的跨度，它可以让异步代码的编程变得像常规的同步函数一样方便, 这对于不管是新手还是js的老司机来说都是一件值得感激的事情。</p></blockquote>]]></content>
      
      <categories>
          
          <category> Web前端 </category>
          
          <category> Javascript </category>
          
          <category> 英文文档翻译 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Async/Await Js </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Javascript 设计模式(一) --- 概念小谈</title>
      <link href="/2018/05/05/Javascript%20%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E4%B8%80/"/>
      <url>/2018/05/05/Javascript%20%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E4%B8%80/</url>
      <content type="html"><![CDATA[<blockquote><p>&emsp;&emsp;编写易于维护的代码, 其中一个最重要方面是能够找到代码中重复出现的主题并优化他们, 这也是设计模式有价值的地方, 设计模式不仅适用于原生javascript(既标准javascript代码), 也适用于jQuery库和Dojo等抽象库, 以下内容就是对这本设计模式做的一个读书笔记.</p></blockquote><h2 id="什么是模式"><a href="#什么是模式" class="headerlink" title="什么是模式?"></a>什么是模式?</h2><p>&emsp;&emsp;模式是一种可复用的解决方案, 可用于解决软件设计中遇到的常见问题, 如在我们编写的Javascript应用程序的实例中, 另一种模式的方式是将解决问题的方法制作成模板, 并且这些模板可应用于多种不同的情况.</p><h2 id="反模式"><a href="#反模式" class="headerlink" title="反模式"></a>反模式</h2><ul><li>在全局上下文中定义大量的变量污染全局命名空间</li><li>向 setTimeout 和 setInterval 传递字符串, 而不是函数, 这会触发eval() 的内部使用</li><li>修改 Object 类的原型 (<strong>这是一个特别不良的反模式</strong>)</li><li>以内联形式使用 Javascript , 它是不可改变的</li><li>在使用 <code>document.creatElement</code> 等原生 DOM 方法更合适的情况下使用 document.write</li></ul><h2 id="设计模式类型"><a href="#设计模式类型" class="headerlink" title="设计模式类型"></a>设计模式类型</h2><h3 id="创建型设计模式"><a href="#创建型设计模式" class="headerlink" title="创建型设计模式"></a>创建型设计模式</h3><ul><li>创建型设计模式专注于处理对象创建机制, 以适合给定情况的方式来创建对象</li><li>属于这个类型的有: Constructor(构造器) Factory(工厂) Abstract(抽象) Prototype(原型) Singleton(单例) 和 Builder(生成器)</li></ul><h3 id="结构型设计模式"><a href="#结构型设计模式" class="headerlink" title="结构型设计模式"></a>结构型设计模式</h3><ul><li>与对象组合有关, 通常用于找出在不同对象之间建立关系的简单方法</li><li>属于这个类型的有: Decorator(装饰器) Facade(外观) Flyweight(享元) Adapter(适配器) 和 Proxy(代理)</li></ul><h3 id="行为设计模式"><a href="#行为设计模式" class="headerlink" title="行为设计模式"></a>行为设计模式</h3><ul><li>专注于改善或简化系统中不同对象之间的通信 </li><li>属于这个类型的有: Iterator(迭代器) Mediator(中介者) Observer(观察者) 和 Visitor(访问者)</li></ul><h2 id="Javascript设计模式"><a href="#Javascript设计模式" class="headerlink" title="Javascript设计模式"></a>Javascript设计模式</h2><h3 id="Constructor-构造器-模式"><a href="#Constructor-构造器-模式" class="headerlink" title="Constructor (构造器) 模式"></a>Constructor (构造器) 模式</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;Constructor是一种在内存已分配给该对象的情况下, 用于初始化新创建对象的特殊方法, 我们最感兴趣的是 <code>Object</code> 构造器 (用于创建特定类型的对象)</p><h4 id="对象创建"><a href="#对象创建" class="headerlink" title="对象创建"></a>对象创建</h4><ul><li><p>创建对象的两种常用方法</p><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. 字面量的方法</span></span><br><span class="line"><span class="keyword">var</span> <span class="keyword">new</span><span class="type">Obj</span> = &#123;&#125;</span><br><span class="line"><span class="comment">// 2. object构造器的简洁记法</span></span><br><span class="line"><span class="keyword">var</span> <span class="keyword">new</span><span class="type">Obj</span> = <span class="keyword">new</span> <span class="type">Object</span>()</span><br></pre></td></tr></table></figure></li><li><p>给对象赋值的四种方法</p><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. '点' 的语法</span></span><br><span class="line"><span class="keyword">new</span><span class="type">Obj</span>.someKey = <span class="string">'Hello world'</span>; <span class="comment">// 设置属性</span></span><br><span class="line"><span class="keyword">var</span> key = <span class="keyword">new</span><span class="type">Obj</span>.someKey; <span class="comment">// 获取属性</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. 中括号语法 </span></span><br><span class="line"><span class="keyword">new</span><span class="type">Obj</span>[<span class="string">'someKey'</span>] = <span class="string">'Hello world'</span>; <span class="comment">// 设置属性</span></span><br><span class="line"><span class="keyword">var</span> key = <span class="keyword">new</span><span class="type">Obj</span>[<span class="string">'someKey'</span>]; <span class="comment">// 获取属性</span></span><br><span class="line"></span><br><span class="line">**下面两个只适用ECMAScript <span class="number">5</span>**</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. Object.defineProperty</span></span><br><span class="line"><span class="keyword">var</span> defineProp = <span class="function"><span class="keyword">function</span></span>(obj, key, value) &#123;</span><br><span class="line">  config.value = value;</span><br><span class="line">  Object.defineProperty(obj, key, config)</span><br><span class="line">&#125;</span><br><span class="line"> <span class="comment">// 先创建一个空的person对象</span></span><br><span class="line"> <span class="keyword">var</span> person = Object.create(<span class="literal">null</span>);</span><br><span class="line"> <span class="comment">// 然后设置各种属性</span></span><br><span class="line"> defineProp.(person, <span class="string">'car'</span>,<span class="string">'Delorean);</span></span><br><span class="line"><span class="string"> defineProp.(person, '</span>dateOfBirth<span class="string">','</span><span class="number">1981</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 4. Object.defineProperties </span></span><br><span class="line">Object.defineProperties(<span class="keyword">new</span><span class="type">Obj</span>, &#123;</span><br><span class="line">  <span class="string">'someKey'</span>: <span class="type"></span>&#123;</span><br><span class="line">    value: <span class="type"></span>'hello world<span class="string">',</span></span><br><span class="line"><span class="string">    writable: true </span></span><br><span class="line"><span class="string">  &#125;,</span></span><br><span class="line"><span class="string">  '</span>authorKey<span class="string">': &#123;</span></span><br><span class="line"><span class="string">    value: '</span>Carol<span class="string">',</span></span><br><span class="line"><span class="string">    writable: false </span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">&#125;)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">//可以用1和2中获取属性的方式获取3和4方式中的属性**</span></span><br></pre></td></tr></table></figure></li></ul><h4 id="基本-Constructor-构造器"><a href="#基本-Constructor-构造器" class="headerlink" title="基本 Constructor (构造器)"></a>基本 Constructor (构造器)</h4><p>通过在构造器前面加<code>new</code>关键字, 告诉Javascript像使用构造器一样实例化一个新对象, 并且对象成员由该函数定义, 在构造器内, 关键字<code>this</code>引用新创建的对象</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义一个构造函数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Car</span>(<span class="params">model, year , miles</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.model = model;</span><br><span class="line">  <span class="keyword">this</span>.year = year;</span><br><span class="line">  <span class="keyword">this</span>.miles = miles;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">this</span>.toString = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.model + <span class="string">' has done '</span> + <span class="keyword">this</span>.miles + miles;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 用法, 使用new关键字创建car的实例</span></span><br><span class="line"><span class="keyword">var</span> civic = <span class="keyword">new</span> Car(<span class="string">'BMW'</span>, <span class="number">2009</span>, <span class="number">20000</span>);</span><br><span class="line"><span class="keyword">var</span> mondeo = <span class="keyword">new</span> Car(<span class="string">'Ford Mondeo'</span>, <span class="number">2009</span>, <span class="number">20000</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 每一个实例都可以使用toString方法</span></span><br><span class="line"><span class="built_in">console</span>.log(civic.toString())</span><br></pre></td></tr></table></figure><blockquote><p>这里有两个问题: 一个是继承比较困难, 第二个是 toString方法是为每一个实例分别重新定义的, 这不太理想</p></blockquote><h4 id="带原型的-Constructor-构造器"><a href="#带原型的-Constructor-构造器" class="headerlink" title="带原型的 Constructor (构造器)"></a>带原型的 Constructor (构造器)</h4><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 改造一下上面一个构造函数的写法</span></span><br><span class="line">Car.prototype.toString = <span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.model + <span class="string">' has done '</span> + <span class="keyword">this</span>.miles + miles;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">**__这样的话, toString()的单一实例就能在所有的Car实例之间共享__**</span><br></pre></td></tr></table></figure><p><em>我们这里可以使用Object.prototype.newMethod, 而不使用Object.prototype是为了避免重新定义prototype对象</em></p><h3 id="Module-模块-模式"><a href="#Module-模块-模式" class="headerlink" title="Module (模块) 模式"></a>Module (模块) 模式</h3><p>在Javascript中, 有几种实现模块的方法 (<font color="blue">Module模式在某种程度上是基于对象字面量</font>)</p><ul><li>对象字面量表示法</li><li>Module 模块</li><li>AMD 模块</li><li>CommonJS 模块</li><li>ECMAScript Harmony 模块</li></ul><h4 id="对象字面量"><a href="#对象字面量" class="headerlink" title="对象字面量"></a>对象字面量</h4><p>对象字面量不需要使用 new 关键字进行实例化, 但不能用在一个语句的开头, 对象字面量可以包含属性和方法<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> myModule = &#123;</span><br><span class="line">  myProperty: <span class="string">'someKey'</span>,</span><br><span class="line">  myConfig : &#123;</span><br><span class="line">    useCacheing: <span class="literal">true</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 方法</span></span><br><span class="line">  myMethod: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'hello world'</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用</span></span><br><span class="line">myModule.myMethod()</span><br></pre></td></tr></table></figure></p><h4 id="Module-模块-模式-1"><a href="#Module-模块-模式-1" class="headerlink" title="Module (模块) 模式"></a>Module (模块) 模式</h4><p>模块模式使用闭包封装’私有’状态和组织, 它提供了一直包装混合公有/私有方法和变量的方式, 防止其泄露至全局变量, 这为我们提供了一个屏蔽处理底层事件逻辑的整洁解决方案, 该模式除了返回一个对象而不是一个函数之外, 非常类似于一个立即调用的函数表达式</p><p> 我们可以使用这种模式实现简单的购物车<br> <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> basketModule = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 私有属性和方法</span></span><br><span class="line">  <span class="keyword">var</span> basket = [];</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">dosomethingPrivate</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    ...</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 返回一个暴露出的公有对象</span></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="comment">// 添加item到购物车</span></span><br><span class="line">    addItem: <span class="function"><span class="keyword">function</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">      basket.push(value);</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 获取购物车里的item个数</span></span><br><span class="line">    getItemCount: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> basket.length;</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 私有函数的公有化别名</span></span><br><span class="line">    doSomething: dosomethingPrivate,</span><br><span class="line"></span><br><span class="line">   <span class="comment">// ...其他函数. 操作等</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用: basketModule返回一个拥有公有API的对象</span></span><br><span class="line">baskModule.addItem(&#123;</span><br><span class="line">  item: <span class="string">'bread'</span>,</span><br><span class="line">  price: <span class="number">4</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">console</span>.log(baskModule.getItemCount) <span class="comment">/// 输出1</span></span><br></pre></td></tr></table></figure></p><p> <em>注意: 这里的basket并没有暴露出来, 只存在于basketModule的闭包作用域里面, 外界无法使用</em></p><h4 id="优缺点"><a href="#优缺点" class="headerlink" title="优缺点"></a>优缺点</h4><ul><li>优点: 可以使脚本语法更加一致, 很容易指出哪些函数和变量可以被公开访问, 提高可读性</li><li>缺点: 如果一个私有函数引用一个公有函数, 在需要补丁时, 公有函数是不能被覆盖的. 引用私有变量的公有对象成员也遵守无补丁规则</li></ul><h3 id="Singleton-单例"><a href="#Singleton-单例" class="headerlink" title="Singleton (单例)"></a>Singleton (单例)</h3><ul><li>定义: 单例模式就是在实例不存在的情况下, 可以通过一个方法创建一个类来实现创建类的新实例, 如果实例已经存在, 他会简单返回该对象的引用</li><li>在Javascript中, Singleton充当共享资源命名空间, 从全局命名空间中隔离出代码实现, 从而为函数提供单一访问点</li><li>适用性:<ul><li>当类只能有一个实例而且用户可以从一个众所周知的访问点访问它时</li><li>该唯一的实例是通过子类化可扩展的, 并且客户应该无需更改代码就能使用一个扩展的实例时</li></ul></li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> Singletontester = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">Singleton</span>(<span class="params">option</span>) </span>&#123;</span><br><span class="line">      option = option || &#123;&#125;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 设置一些属性</span></span><br><span class="line">      <span class="keyword">this</span>.name = <span class="string">'Singletontester'</span>;</span><br><span class="line">      <span class="keyword">this</span>.pointX = option.pointX || <span class="number">6</span>;</span><br><span class="line">      <span class="keyword">this</span>.pointY = option.pointY || <span class="number">6</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 实例持有者</span></span><br><span class="line">    <span class="keyword">var</span> instance;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 静态变量和方法的模拟</span></span><br><span class="line">    <span class="keyword">var</span> _static = &#123;</span><br><span class="line">      name: <span class="string">'Carol'</span>,</span><br><span class="line">      <span class="comment">// 获取实例的方法, 返回Singleton对象的singleton实例</span></span><br><span class="line">      getInstance: <span class="function"><span class="keyword">function</span>(<span class="params">options</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(instance === <span class="literal">undefined</span>) &#123;</span><br><span class="line">          instance = <span class="keyword">new</span> Singleton(options);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">return</span> _static;</span><br><span class="line"> &#125;)()</span><br><span class="line"></span><br><span class="line"> <span class="comment">// 使用</span></span><br><span class="line"> <span class="keyword">var</span> test = Singletontester.getInstance(&#123;</span><br><span class="line">   pointX: <span class="number">5</span></span><br><span class="line"> &#125;)</span><br><span class="line"> <span class="built_in">console</span>.log(test.pointX) <span class="comment">// 输出</span></span><br></pre></td></tr></table></figure>]]></content>
      
      <categories>
          
          <category> Web前端 </category>
          
          <category> Javascript </category>
          
          <category> 设计模式 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 设计模式 Js </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Git入门与进阶</title>
      <link href="/2018/04/18/Git%E5%85%A5%E9%97%A8%E4%B8%8E%E8%BF%9B%E9%98%B6/"/>
      <url>/2018/04/18/Git%E5%85%A5%E9%97%A8%E4%B8%8E%E8%BF%9B%E9%98%B6/</url>
      <content type="html"><![CDATA[<p><img src="https://github.com/shitouxiaocheng01/JavaNotes/raw/master/Img/Git/log.png" alt=""></p><blockquote><p>&emsp;&emsp;Git 是一个开源的分布式版本控制系统，用于敏捷高效地处理任何或小或大的项目，是 Linus Torvalds 为了帮助管理 Linux 内核开发而开发的一个开放源码的版本控制软件。Git 与常用的版本控制工具 CVS, Subversion 等不同，它采用了分布式版本库的方式，不必服务器端软件支持。</p></blockquote><h3 id="Git-与-SVN-对比"><a href="#Git-与-SVN-对比" class="headerlink" title="Git 与 SVN 对比"></a>Git 与 SVN 对比</h3><ul><li>SVN 是集中式版本控制软件，版本库是放在中央服务器，当我们进行项目开发时，首先要从中央服务器获取最新版本；开发完毕后要将代码提交到中央服务器。<font color="red">集中版本式控制系统必须联网才能工作，即使是局域网也必须保持与局域网服务器的连接。</font></li><li>Git 是分布式版本控制软件，它没有中央服务器一说，每个人的电脑就是一个完整的版本库。当我们需要共享文件的时候只需要创建一个共享版本库进行push或pull就能看到对方修改。</li></ul><h3 id="Git-工作流程"><a href="#Git-工作流程" class="headerlink" title="Git 工作流程"></a>Git 工作流程</h3><p>&emsp;&emsp;一般工作流程如下（具体命令步骤将在下文提出）：</p><ul><li>从远程仓库克隆代码到本地作为本地库（可直接克隆至编辑器工作空间）</li><li>代码开发完毕后提交至本地仓库</li><li>从远程仓库拉取最新版代码，有冲突解决冲突（有冲突时本地仓库文件夹会有“!”标记，有可能标记会有延迟）。</li><li>处理好本地库代码后提交到远程库共享代码</li></ul><h3 id="Git-的下载与安装"><a href="#Git-的下载与安装" class="headerlink" title="Git 的下载与安装"></a>Git 的下载与安装</h3><p>&emsp;&emsp;由于本人使用的是 windows 系统，所以只阐述 windows 下 git 的安装及使用。</p><ul><li><p>Git 软件下载</p><p>  官方下载地址：<strong><a href="https://git-scm.com/download" target="_blank" rel="noopener">https://git-scm.com/download</a></strong></p></li><li><p>Git 软件安装</p><p>  下载完成之后双击进行安装，选择自己的安装路径，傻瓜式 next 一路到底。</p></li></ul><h3 id="Git-本地仓库"><a href="#Git-本地仓库" class="headerlink" title="Git 本地仓库"></a>Git 本地仓库</h3><blockquote><p>&emsp;&emsp;版本库又名仓库，repository，可以理解成一个目录，这个目录里面所有文件都将被 Git 管理起来，每个文件的修改、删除、新增，Git 都能跟踪，并且在无需联网的情况下具有完整的版本管理能力。</p></blockquote><ul><li>创建本地版本库</li></ul><p>在磁盘里任选并进入一个文件夹，右击空白处，如下：</p><p><img src="https://github.com/shitouxiaocheng01/JavaNotes/raw/master/Img/Git/pic1.png" alt=""></p><p>点击 <code><strong>Git Bash Here</strong></code>，在出现的窗口中输入 <code><strong>git init</strong></code>，并且将会出现隐藏文件夹 <code><strong>.git</strong></code>。演示里面的文件夹 Git Test 就是我们所说的工作区，隐藏文件夹 <code><strong>.git</strong></code> 就是版本库。</p><p><img src="https://github.com/shitouxiaocheng01/JavaNotes/raw/master/Img/Git/pic2.png" alt=""></p><h3 id="Git-远程仓库"><a href="#Git-远程仓库" class="headerlink" title="Git 远程仓库"></a>Git 远程仓库</h3><blockquote><p>&emsp;&emsp;目前我们已经有了本地 Git 仓库，如果需要协作开发，则必须有一个远程仓库。常用的远程仓库是 github：<strong><a href="https://github.com/" target="_blank" rel="noopener">https://github.com/</a></strong>。</p></blockquote><ul><li>创建 Github 账号（各自摸索…）</li><li>创建远程仓库：</li></ul><p><img src="https://github.com/shitouxiaocheng01/JavaNotes/raw/master/Img/Git/pic3.png" alt=""></p><p>填写好仓库名称，仓库描述，选择 <code>Public</code>( <code>Private 是付费的</code>)，就可以 <code>Create repository</code> 了。</p><p><img src="https://github.com/shitouxiaocheng01/JavaNotes/raw/master/Img/Git/pic4.png" alt=""></p><ul><li>SSH 密匙</li></ul><blockquote><p>&emsp;&emsp;SSH 是英文 Secure Shell的简写形式。通过使用 SSH，它可以把所有传输的数据进行加密，这样可以防止 DNS 欺骗和 IP 欺骗。目前 Github 采用这种方式对传输数据进行加密。</p></blockquote><p>在 windows 系统下，我们使用 <code><strong>Git Bash.exe</strong></code> 来生成密匙，命令： <code><strong>ssh-keygen -t rsa</strong></code>。具体操作如下图：</p><p><img src="https://github.com/shitouxiaocheng01/JavaNotes/raw/master/Img/Git/pic5.png" alt=""></p><p>执行完命令后，会在 windows <font color="red">本地用户下的 <strong>.ssh</strong> 目录下生成公钥和私钥</font>。</p><p><img src="https://github.com/shitouxiaocheng01/JavaNotes/raw/master/Img/Git/pic6.png" alt=""></p><p>密钥生成后，需要在 Github 上配置密匙本地才能访问，操作如下：</p><p><img src="https://github.com/shitouxiaocheng01/JavaNotes/raw/master/Img/Git/pic7.png" alt=""></p><p>点击 <strong>Settings</strong>，选中右边侧边栏的 <strong>SSH and GPS keys</strong>，再点击右上角出现 <strong>New SSH key</strong>，将本地的<font color="red"><strong>公钥</strong></font>里面的信息全部复制，按下图操作：</p><p><img src="https://github.com/shitouxiaocheng01/JavaNotes/raw/master/Img/Git/pic8.png" alt=""></p><p>点击 <strong>And SSH key</strong> 按钮完成配置！</p><h3 id="连接-Git-远程仓库并同步"><a href="#连接-Git-远程仓库并同步" class="headerlink" title="连接 Git 远程仓库并同步"></a>连接 Git 远程仓库并同步</h3><ol><li>初始化账号：我们是第一次连接远程仓库，本地 Git 并不知道我们的身份，因此我们需初始化自己的身份；<ul><li>git config user.name “你的Github账号名称(非邮箱)”</li><li>git config user.email “你的Github邮箱”</li></ul></li></ol><p><img src="https://github.com/shitouxiaocheng01/JavaNotes/raw/master/Img/Git/pic9.png" alt=""></p><ol start="2"><li>添加远程仓库<ul><li>git remote add 远端名称 远程库 SSH 地址</li></ul></li></ol><p><img src="https://github.com/shitouxiaocheng01/JavaNotes/raw/master/Img/Git/pic10.png" alt=""></p><ol start="3"><li>提交到 Github 远程仓库（个人在项目开发中使用的操作）<ul><li>git status（查看当前状态，包括当前分支、增删改过的文件）</li><li>git add . （将当前目录下的所有操作过的文件添加）</li><li>git commit -m’提交说明’ （提交到本地仓库）</li><li>git pull （拉取远程库的文件，每次提交到本地库后需进行此操作，有冲突则要修改并merge）</li><li>git push （将拉取和自己操作过的文件提交至远程仓库）</li></ul></li></ol><p><img src="https://github.com/shitouxiaocheng01/JavaNotes/raw/master/Img/Git/pic11.png" alt=""></p><ol start="4"><li>完成所有操作后我们可以在自己的 Github 上查看自己所提交的内容</li></ol><p><img src="https://github.com/shitouxiaocheng01/JavaNotes/raw/master/Img/Git/pic12.png" alt=""></p><p> <strong>以上是本人的浅显理解，如有错误，请指正，感激不尽！</strong></p>]]></content>
      
      <categories>
          
          <category> Web前端 </category>
          
          <category> git </category>
          
      </categories>
      
      
        <tags>
            
            <tag> git </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Vuejs最佳实践方法</title>
      <link href="/2018/04/18/Vuejs%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/"/>
      <url>/2018/04/18/Vuejs%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/</url>
      <content type="html"><![CDATA[<p><img src="/2018/04/18/Vuejs最佳实践/vue.png" alt=""></p><blockquote><p>&emsp;&emsp;对大部分人来说，掌握Vue.js基本的几个API后就已经能够正常地开发前端网站。但如果你想更加高效地使用Vue来开发，下面几个方法能更好的适用于vue场景。</p></blockquote><h3 id="第一招-化繁为简的watchers"><a href="#第一招-化繁为简的watchers" class="headerlink" title="第一招: 化繁为简的watchers"></a>第一招: 化繁为简的watchers</h3><p><strong><em>场景还原:</em></strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">created()&#123;</span><br><span class="line">  <span class="keyword">this</span>.fetchPostList()</span><br><span class="line">&#125;,</span><br><span class="line">watch: &#123;</span><br><span class="line">    searchInputValue()&#123;</span><br><span class="line">       <span class="keyword">this</span>.fetchPostList()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>组件创建的时候我们获取一次列表，同时监听input框，每当发生变化的时候重新获取一次筛选后的列表这个场景很常见，有没有办法优化一下呢？</li></ul><p><strong><em>招式解析：</em></strong></p><ul><li>首先，在<code>watchers</code>中，可以直接使用函数的字面量名称；其次，声明<code>immediate:true</code>表示创建组件时立马执行一次。</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">watch: &#123;</span><br><span class="line">  searchInputValue:&#123;</span><br><span class="line">    handler: <span class="string">'fetchPostList'</span>,</span><br><span class="line">    immediate: <span class="literal">true</span></span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="第二招：一劳永逸的组件注册"><a href="#第二招：一劳永逸的组件注册" class="headerlink" title="第二招：一劳永逸的组件注册"></a>第二招：一劳永逸的组件注册</h3><p><strong><em>场景还原:</em></strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> BaseButton <span class="keyword">from</span> <span class="string">'./baseButton'</span></span><br><span class="line"><span class="keyword">import</span> BaseIcon <span class="keyword">from</span> <span class="string">'./baseIcon'</span></span><br><span class="line"><span class="keyword">import</span> BaseInput <span class="keyword">from</span> <span class="string">'./baseInput'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  components: &#123;</span><br><span class="line">    BaseButton,</span><br><span class="line">    BaseIcon,</span><br><span class="line">    BaseInput</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;BaseInput v-model=<span class="string">"searchText"</span> @keydown.enter=<span class="string">"search"</span>/&gt;</span><br><span class="line">&lt;BaseButton @click=<span class="string">"search"</span>&gt;</span><br><span class="line">  &lt;BaseIcon name=<span class="string">"search"</span>/&gt;</span><br><span class="line">&lt;<span class="regexp">/BaseButton&gt;</span></span><br></pre></td></tr></table></figure><ul><li>我们写了一堆基础UI组件，然后每次我们需要使用这些组件的时候，都得先import，然后声明components，很繁琐！秉持能偷懒就偷懒的原则，我们要想办法优化！</li></ul><p><strong><em>招式解析：</em></strong></p><ul><li><p>我们需要借助一下神器webpack，使用 <strong>require.context()</strong> 方法来创建自己的（模块）上下文，从而实现自动动态require组件。这个方法需要3个参数：<font color="#0000dd">要搜索的文件夹目录，是否还应该搜索它的子目录，以及一个匹配文件的正则表达式</font>。</p></li><li><p>我们在components文件夹添加一个叫global.js的文件，在这个文件里借助webpack动态将需要的基础组件统统打包进来。</p></li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">capitalizeFirstLetter</span>(<span class="params">string</span>) </span>&#123;</span><br><span class="line">   <span class="keyword">return</span> string.charAt(<span class="number">0</span>).toUpperCase() + string.slice(<span class="number">1</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> requireComponent = <span class="built_in">require</span>.context(<span class="string">'.'</span>, <span class="literal">false</span>, /\.vue$/) <span class="comment">//找到components文件夹下以.vue命名的文件</span></span><br><span class="line"></span><br><span class="line">requireComponent.keys().forEach(<span class="function"><span class="params">fileName</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> componentConfig = requireComponent(fileName)</span><br><span class="line">  <span class="keyword">const</span> componentName = capitalizeFirstLetter(fileName.replace(<span class="regexp">/^\.\//</span>, <span class="string">''</span>).replace(<span class="regexp">/\.\w+$/</span>, <span class="string">''</span>))</span><br><span class="line"><span class="comment">//因为得到的filename格式是:'./baseButton.vue',所以这里我们去掉头和尾，只保留真正的文件名</span></span><br><span class="line"></span><br><span class="line">  Vue.component(componentName, componentConfig.default || componentConfig)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><ul><li>最后我们在main.js中import ‘components/global.js’，然后我们就可以随时随地使用这些基础组件，无需手动引入了</li></ul><h3 id="第三招：釜底抽薪的router-key"><a href="#第三招：釜底抽薪的router-key" class="headerlink" title="第三招：釜底抽薪的router key"></a>第三招：釜底抽薪的router key</h3><p><strong><em>场景还原:</em></strong></p><ul><li>下面这个场景真的是伤透了很多程序员的心…先默认大家用的是Vue-router来实现路由的控制。假设我们在写一个博客网站，需求是从/post-page/a，跳转到/post-page/b。然后我们惊人的发现，页面跳转后数据竟然没更新？！原因是vue-router”智能地”发现这是同一个组件，然后它就决定要复用这个组件，所以你在created函数里写的方法压根就没执行。通常的解决方案是监听$route的变化来初始化数据，如下：</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">data() &#123;</span><br><span class="line"> <span class="keyword">return</span> &#123;</span><br><span class="line">    loading: <span class="literal">false</span>,</span><br><span class="line">    error: <span class="literal">null</span>,</span><br><span class="line">    post: <span class="literal">null</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br><span class="line">watch: &#123;</span><br><span class="line"> <span class="string">'$route'</span>: &#123;</span><br><span class="line">    handler: <span class="string">'resetData'</span>,</span><br><span class="line">    immediate: <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br><span class="line">methods: &#123;</span><br><span class="line">  resetData() &#123;</span><br><span class="line">   <span class="keyword">this</span>.loading = <span class="literal">false</span></span><br><span class="line">    <span class="keyword">this</span>.error = <span class="literal">null</span></span><br><span class="line">    <span class="keyword">this</span>.post = <span class="literal">null</span></span><br><span class="line">    <span class="keyword">this</span>.getPost(<span class="keyword">this</span>.$route.params.id)</span><br><span class="line">  &#125;,</span><br><span class="line">  getPost(id)&#123;</span><br><span class="line">      <span class="comment">// 操作</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong><em>招式解析：</em></strong></p><ul><li>给router-view添加一个unique的key，这样即使是公用组件，只要url变化了，就一定会重新创建这个组件。（虽然损失了一丢丢性能，但避免了无限的bug）。同时，注意我将key直接设置为路由的完整路径，一举两得。</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;router-view :key=<span class="string">"$route.fullpath"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">router-view</span>&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">data() &#123;</span></span><br><span class="line"><span class="xml">  return &#123;</span></span><br><span class="line"><span class="xml">    loading: false,</span></span><br><span class="line"><span class="xml">    error: null,</span></span><br><span class="line"><span class="xml">    post: null</span></span><br><span class="line"><span class="xml">  &#125;</span></span><br><span class="line"><span class="xml">&#125;,</span></span><br><span class="line"><span class="xml">created () &#123;</span></span><br><span class="line"><span class="xml">  this.getPost(this.$route.params.id)</span></span><br><span class="line"><span class="xml">&#125;,</span></span><br><span class="line"><span class="xml">methods () &#123;</span></span><br><span class="line"><span class="xml">  getPost(postId) &#123;    // ...</span></span><br><span class="line"><span class="xml">  &#125;</span></span><br><span class="line"><span class="xml">&#125;</span></span><br></pre></td></tr></table></figure><h3 id="第四招-无所不能的render函数"><a href="#第四招-无所不能的render函数" class="headerlink" title="第四招: 无所不能的render函数"></a>第四招: 无所不能的render函数</h3><p><strong><em>场景还原:</em></strong></p><ul><li>vue要求每一个组件都只能有一个根元素，当你有多个根元素时，vue就会给你报错</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;li v-<span class="keyword">for</span>=<span class="string">"route in routes"</span> :key=<span class="string">"route.name"</span>&gt;</span><br><span class="line">    &lt;router-link :to=<span class="string">"route"</span>&gt;</span><br><span class="line">      &#123;&#123; route.title &#125;&#125;</span><br><span class="line">    &lt;<span class="regexp">/router-link&gt;</span></span><br><span class="line"><span class="regexp">  &lt;/</span>li&gt;</span><br><span class="line">&lt;<span class="regexp">/template&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">ERROR - Component template should contain exactly one root element. If you are using v-if on multiple elements, use v-else-if to chain them instead.</span></span><br></pre></td></tr></table></figure><p><strong><em>招式解析：</em></strong></p><ul><li>那有没有办法化解呢，答案是有的，只不过这时候我们需要使用render()函数来创建HTML，而不是template。其实用js来生成html的好处就是极度的灵活功能强大，而且你不需要去学习使用vue的那些功能有限的指令API，比如v-for, v-if。（reactjs就完全丢弃了template)</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">functional: <span class="literal">true</span>,</span><br><span class="line">render(h, &#123; props &#125;) &#123;</span><br><span class="line"> <span class="keyword">return</span> props.routes.map(<span class="function"><span class="params">route</span> =&gt;</span></span><br><span class="line">  &lt;li key=&#123;route.name&#125;&gt;</span><br><span class="line">     &lt;router-link to=&#123;route&#125;&gt;</span><br><span class="line">        &#123;route.title&#125;</span><br><span class="line">     &lt;<span class="regexp">/router-link&gt;</span></span><br><span class="line"><span class="regexp">   &lt;/</span>li&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="第五招：无招胜有招的高阶组件"><a href="#第五招：无招胜有招的高阶组件" class="headerlink" title="第五招：无招胜有招的高阶组件"></a>第五招：无招胜有招的高阶组件</h3><p><strong>划重点：这一招威力无穷，请务必掌握</strong></p><ul><li>当我们写组件的时候，通常我们都需要从父组件传递一系列的props到子组件，同时父组件监听子组件emit过来的一系列事件。举例子：</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//父组件</span></span><br><span class="line">&lt;BaseInput :value=<span class="string">"value"</span> label=<span class="string">"密码"</span> placeholder=<span class="string">"请填写密码"</span> @input=<span class="string">"handleInput"</span> @focus=<span class="string">"handleFocus&gt;&lt;/BaseInput&gt;</span></span><br><span class="line"><span class="string">//子组件</span></span><br><span class="line"><span class="string">&lt;template&gt;</span></span><br><span class="line"><span class="string">  &lt;label&gt;</span></span><br><span class="line"><span class="string">    &#123;&#123; label &#125;&#125;</span></span><br><span class="line"><span class="string">    &lt;input :value="</span>value<span class="string">" :placeholder="</span>placeholder<span class="string">" @focus=$emit('focus', $event)"</span> @input=<span class="string">"$emit('input', $event.target.value)"</span> &gt;</span><br><span class="line">  &lt;<span class="regexp">/label&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>template&gt;</span><br></pre></td></tr></table></figure><p><strong>有下面几个优化点：</strong></p><ul><li>1、每一个从父组件传到子组件的props,我们都得在子组件的Props中显式的声明才能使用。这样一来，我们的子组件每次都需要申明一大堆props, 而类似placeholer这种dom原生的property我们其实完全可以直接从父传到子，无需声明。方法如下：</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;input :value=<span class="string">"value"</span>  v-bind=<span class="string">"$attrs"</span> @input=<span class="string">"$emit('input', $event.target.value)"</span>&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">// attrs包含了父作用域中不作为 prop 被识别 (且获取) 的特性绑定 (class 和 style 除外)。当一个组件没有声明任何 prop 时，这里会包含所有父作用域的绑定，并且可以通过 v-bind="$attrs" 传入内部组件——在创建更高层次的组件时非常有用。</span></span><br></pre></td></tr></table></figure><ul><li>2、注意到子组件的@focus= $emit(‘focus’, $event) 其实什么都没做，只是把event传回给父组件而已，那其实和上面类似，我完全没必要显式地申明：</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;input :value=<span class="string">"value"</span> v-bind=<span class="string">"$attrs"</span>  v-on=<span class="string">"listeners"</span>&gt;</span><br><span class="line"></span><br><span class="line">computed: &#123;</span><br><span class="line">  listeners() &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">       ...this.$listeners,</span><br><span class="line">       input: <span class="function"><span class="params">event</span> =&gt;</span> <span class="keyword">this</span>.$emit(<span class="string">'input'</span>,event.target.value)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//$listeners包含了父作用域中的 (不含 .native 修饰器的) v-on 事件监听器。它可以通过 v-on="$listeners" 传入内部组件——在创建更高层次的组件时非常有用。</span></span><br></pre></td></tr></table></figure><ul><li>3、需要注意的是，由于我们input并不是BaseInput这个组件的根节点，而默认情况下父作用域的不被认作 props 的特性绑定将会“回退”且作为普通的 HTML 特性应用在子组件的根元素上。所以我们需要设置 <font color="#dd00dd"><strong>inheritAttrs:false</strong></font>，这些默认行为将会被去掉, 以上两点的优化才能成功。</li></ul>]]></content>
      
      <categories>
          
          <category> Web前端 </category>
          
          <category> Vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vue </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>搭建属于自己的博客</title>
      <link href="/2018/04/16/%E6%90%AD%E5%BB%BAhexo%E5%8D%9A%E5%AE%A2/"/>
      <url>/2018/04/16/%E6%90%AD%E5%BB%BAhexo%E5%8D%9A%E5%AE%A2/</url>
      <content type="html"><![CDATA[<blockquote><p>&emsp;&emsp;自从学习前端一来, 一直想自己搭建一个独立的博客, 也纠结过是否直接使用第三方博客平台, 但是每次看到网页上面的广告就无法忍受, 所以想来想去还是决定用自己搭建的, 刚好自己是学前端的, 好像没有搭建过博客就说不过去，虽然网上面的教程有很多, 但是还是想自己记录一下学习过程, 下面就开始吧。</p></blockquote><h3 id="开发环境（windows）"><a href="#开发环境（windows）" class="headerlink" title="开发环境（windows）"></a>开发环境（windows）</h3><h4 id="安装-Node-js-和-Git"><a href="#安装-Node-js-和-Git" class="headerlink" title="安装 Node.js 和 Git"></a>安装 Node.js 和 Git</h4><p> 直接到官网下载安装即可 <a href="https://nodejs.org/en/" target="_blank" rel="noopener">NodeJS</a><br> Git 也可以直接在官网去下载</p><h4 id="安装Hexo"><a href="#安装Hexo" class="headerlink" title="安装Hexo"></a>安装Hexo</h4><p> 安装完node.js和git之后，即可以通过npm安装hexo了, 打开git bash,键入以下命令<br>  <figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g hexo-<span class="keyword">cli</span></span><br></pre></td></tr></table></figure></p><p>  安装完成后可以通过 <code>hexo -v</code> 查看 hexo 版本信息</p><h3 id="初始化"><a href="#初始化" class="headerlink" title="初始化"></a>初始化</h3><p>  安装 Hexo 完成后，请执行下列命令，Hexo 将会在指定文件夹中新建所需要的文件<br>  <figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hexo init <span class="symbol">&lt;folder&gt;</span></span><br><span class="line"><span class="keyword">cd</span> <span class="symbol">&lt;folder&gt;</span></span><br><span class="line">npm install</span><br></pre></td></tr></table></figure></p><p>  初始化完成后，你会在该文件夹下得到如下的目录结构:<br>  <figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">.</span><br><span class="line">├── _config.yml</span><br><span class="line">├── <span class="keyword">package</span>.json</span><br><span class="line">├── scaffolds</span><br><span class="line">├── <span class="keyword">public</span></span><br><span class="line">├── <span class="keyword">source</span></span><br><span class="line">|   └── _posts</span><br><span class="line">└── themes</span><br></pre></td></tr></table></figure></p><h3 id="本地启动"><a href="#本地启动" class="headerlink" title="本地启动"></a>本地启动</h3><p>执行命令 <code>hexo s</code><br>成功启动则会看到反馈信息<br>[info] Hexo is running at <a href="http://localhost:4000/" target="_blank" rel="noopener">http://localhost:4000/</a>. Press Ctrl+C to stop.<br>此时端口4000被打开，打开浏览器，输入上面所示网址<br>出现了默认的主题界面，心情是不是有点小激动呢~<br><img src="/2018/04/16/搭建hexo博客/hexo-web.png" alt=""><br>到此为止hexo的初始化已经完成，接下来就是相关配置。</p><h3 id="博客配置"><a href="#博客配置" class="headerlink" title="博客配置"></a>博客配置</h3><p>博客的基本配置都在 <code>_config.yml</code> 文件中打开该文件我们可以看到，在其中我们可以对网站显示的相关个人信息进行修改以及主题的使用的等。<br><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Hexo Configuration</span></span><br><span class="line"><span class="comment">## Docs: https://hexo.io/docs/configuration.html</span></span><br><span class="line"><span class="comment">## Source: https://github.com/hexojs/hexo/</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Site</span></span><br><span class="line"><span class="attr">title:</span> <span class="string">静默如初</span>  <span class="comment">#博客名</span></span><br><span class="line"><span class="attr">subtitle:</span> <span class="string">The</span> <span class="string">Greatness</span> <span class="string">is</span> <span class="string">Achieved</span> <span class="string">through</span> <span class="string">Diligence</span> <span class="string">and</span> <span class="string">Retarded</span> <span class="string">by</span> <span class="string">Laziness.</span> <span class="comment">#副标题</span></span><br><span class="line"><span class="attr">description:</span> <span class="string">努力中的前端开发工程师</span></span><br><span class="line"><span class="attr">keywords:</span> <span class="comment">#关键字</span></span><br><span class="line"><span class="attr">author:</span> <span class="string">Carol</span> <span class="comment">#作者</span></span><br><span class="line"><span class="attr">language:</span> <span class="string">zh-CN</span><span class="comment">#语言</span></span><br><span class="line"><span class="attr">timezone:</span>  <span class="comment">#时区，此处不填写，hexo会以你目前电脑的时区为默认值</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># URL</span></span><br><span class="line"><span class="comment">## If your site is put in a subdirectory, set url as 'http://yoursite.com/child' and root as '/child/'</span></span><br><span class="line"><span class="attr">url:</span> <span class="attr">http://www.luo01.cn</span>  <span class="comment">#域名</span></span><br><span class="line"><span class="attr">root:</span> <span class="string">/</span></span><br><span class="line"><span class="attr">permalink:</span> <span class="string">:year/:month/:day/:title/</span></span><br><span class="line"><span class="attr">permalink_defaults:</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Directory  暂不配置，使用默认值</span></span><br><span class="line"><span class="attr">source_dir:</span> <span class="string">source</span></span><br><span class="line"><span class="attr">public_dir:</span> <span class="string">public</span></span><br><span class="line"><span class="attr">tag_dir:</span> <span class="string">tags</span></span><br><span class="line"><span class="attr">archive_dir:</span> <span class="string">archives</span></span><br><span class="line"><span class="attr">category_dir:</span> <span class="string">categories</span></span><br><span class="line"><span class="attr">code_dir:</span> <span class="string">downloads/code</span></span><br><span class="line"><span class="attr">i18n_dir:</span> <span class="string">:lang</span></span><br><span class="line"><span class="attr">skip_render:</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Writing 文章布局等，使用默认值</span></span><br><span class="line"><span class="attr">new_post_name:</span> <span class="string">:title.md</span> <span class="comment"># File name of new posts</span></span><br><span class="line"><span class="attr">default_layout:</span> <span class="string">post</span></span><br><span class="line"><span class="attr">titlecase:</span> <span class="literal">false</span> <span class="comment"># Transform title into titlecase</span></span><br><span class="line"><span class="attr">external_link:</span> <span class="literal">true</span> <span class="comment"># Open external links in new tab</span></span><br><span class="line"><span class="attr">filename_case:</span> <span class="number">0</span></span><br><span class="line"><span class="attr">render_drafts:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">post_asset_folder:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">relative_link:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">future:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">highlight:</span></span><br><span class="line"><span class="attr">  enable:</span> <span class="literal">true</span> <span class="comment">#高亮</span></span><br><span class="line"><span class="attr">  line_number:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">  auto_detect:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">  tab_replace:</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 数学公式</span></span><br><span class="line"><span class="attr">mathjax:</span> <span class="literal">true</span></span><br><span class="line">  </span><br><span class="line"><span class="comment"># Home page setting</span></span><br><span class="line"><span class="comment"># path: Root path for your blogs index page. (default = '')</span></span><br><span class="line"><span class="comment"># per_page: Posts displayed per page. (0 = disable pagination)</span></span><br><span class="line"><span class="comment"># order_by: Posts order. (Order by date descending by default)</span></span><br><span class="line"><span class="attr">index_generator:</span></span><br><span class="line"><span class="attr">  path:</span> <span class="string">''</span></span><br><span class="line"><span class="attr">  per_page:</span> <span class="number">10</span></span><br><span class="line"><span class="attr">  order_by:</span> <span class="bullet">-date</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 本地搜索</span></span><br><span class="line"><span class="attr">search:</span></span><br><span class="line"><span class="attr">  path:</span> <span class="string">search.xml</span></span><br><span class="line"><span class="attr">  field:</span> <span class="string">post</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Category &amp; Tag</span></span><br><span class="line"><span class="attr">default_category:</span> <span class="string">uncategorized</span></span><br><span class="line"><span class="attr">category_map:</span></span><br><span class="line"><span class="attr">tag_map:</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Date / Time format 时间格式</span></span><br><span class="line"><span class="comment">## Hexo uses Moment.js to parse and display date</span></span><br><span class="line"><span class="comment">## You can customize the date format as defined in</span></span><br><span class="line"><span class="comment">## http://momentjs.com/docs/#/displaying/format/</span></span><br><span class="line"><span class="attr">date_format:</span> <span class="string">YYYY-MM-DD</span></span><br><span class="line"><span class="attr">time_format:</span> <span class="attr">HH:mm:ss</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Pagination</span></span><br><span class="line"><span class="comment">## Set per_page to 0 to disable pagination</span></span><br><span class="line"><span class="attr">per_page:</span> <span class="number">10</span>  <span class="comment">#每页显示的文章数，0表示不分页</span></span><br><span class="line"><span class="attr">pagination_dir:</span> <span class="string">page</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Extensions 插件配置</span></span><br><span class="line"><span class="comment">## Plugins: https://hexo.io/plugins/</span></span><br><span class="line"><span class="comment">## Themes: https://hexo.io/themes/</span></span><br><span class="line"><span class="attr">theme:</span> <span class="string">maupassant</span>  <span class="comment">#使用的主题</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Deployment  用于部署到github</span></span><br><span class="line"><span class="comment">## Docs: https://hexo.io/docs/deployment.html</span></span><br><span class="line"><span class="attr">deploy:</span></span><br><span class="line"><span class="attr">  type:</span> <span class="string">git</span></span><br><span class="line"><span class="attr">  repository:</span> <span class="string">git@github.com:XiaoLuo01/XiaoLuo01.github.io.git</span></span><br><span class="line"><span class="attr">  branch:</span> <span class="string">master</span></span><br></pre></td></tr></table></figure></p><h3 id="创建新文章"><a href="#创建新文章" class="headerlink" title="创建新文章"></a>创建新文章</h3><p>执行命令 <code>hexo n “我的第一篇博文”</code><br>系统会自动在<code>_post </code>目录下生成文件 “我的第一篇博文.md”<br>之后用编辑器编辑md文件就好啦！（要用markdown语法编辑哦~）<br>markdown的语法可以参考 <a href="http://ibruce.info/2013/11/26/markdown/" target="_blank" rel="noopener">http://ibruce.info/2013/11/26/markdown/</a> 以及一些搜索到的教程。</p><h3 id="hexo的其他指令"><a href="#hexo的其他指令" class="headerlink" title="hexo的其他指令"></a>hexo的其他指令</h3><p>下面只写一些常用命令及部分简写<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">hexo n == hexo new 新建文件</span><br><span class="line">hexo g == hexo generate 生成静态文件</span><br><span class="line">hexo s == hexo<span class="built_in"> server </span>启动服务器</span><br><span class="line">heox d == hexo deploy 部署网站</span><br><span class="line">hexo list 列出网站资料</span><br></pre></td></tr></table></figure></p><p>同时，hexo还支持复合命令，如 <code>hexo d -g </code>意为 先静态化处理，再部署<br>详细指令说明可参阅 <a href="https://hexo.io/zh-cn/docs/commands.html" target="_blank" rel="noopener">https://hexo.io/zh-cn/docs/commands.html</a></p><h3 id="发布到github"><a href="#发布到github" class="headerlink" title="发布到github"></a>发布到github</h3><h4 id="静态化处理"><a href="#静态化处理" class="headerlink" title="静态化处理"></a>静态化处理</h4><p>执行命令 <code>hexo g</code><br>在此说明一下静态化处理的目的，由于我们用hexo所搭建的这个博客，是静态网站，即只有html,css和javascript，无法动态更新。静态化处理即生成只有html、css和javascript的网站。</p><h4 id="部署到github"><a href="#部署到github" class="headerlink" title="部署到github"></a>部署到github</h4><ul><li>注册github帐号</li><li>建立一个仓库，名为<code>[your_user_name.github.io]</code>  <strong>这里必须要注意的是: 一定要以自己的github名命名</strong></li><li>添加SSH公钥到 <font color="red">[Account settings -&gt; SSH Keys -&gt; Add SSH Key]</font></li><li>有了github帐号之后， 编辑配置文件_config.yml，在deploy部分，设置github的项目地址</li></ul><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">deploy</span>:</span><br><span class="line"><span class="attribute">type</span>: git</span><br><span class="line"><span class="attribute">repository</span>: git<span class="variable">@github</span>.<span class="attribute">com</span>:example/example.github.io.git</span><br></pre></td></tr></table></figure><ul><li>添加SSH<br>首先设置用户名和密码:</li></ul><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git<span class="built_in"> config </span>--global user.email <span class="string">"example@163.com"</span></span><br><span class="line">git<span class="built_in"> config </span>--global user.name <span class="string">"example"</span></span><br></pre></td></tr></table></figure><p>然后生成密钥:<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">ssh-keygen</span> <span class="selector-tag">-t</span> <span class="selector-tag">rsa</span> <span class="selector-tag">-C</span> "<span class="selector-tag">example</span>@<span class="keyword">163</span>.<span class="keyword">com</span>"</span><br></pre></td></tr></table></figure></p><p>上述命令如果成功，会在根目录下的.ssh文件夹内生成<code>id_rsa</code>和 <code>id_rsa.pub</code>两个文件<br>打开id_rsa.pub文件，复制里面的内容添加到 Add SSH Key</p><p><img src="/2018/04/16/搭建hexo博客/pic02.png" alt=""></p><p>然后执行命令 <code>hexo d</code><br>若没问题的话会提示你输入帐号密码，之后就部署成功了，可以在github查看，点击仓库上侧的setting, 这页面中可以看到</p><p><img src="/2018/04/16/搭建hexo博客/pic03.png" alt=""><br><strong>这里还需要注意的是: source需要设置为master分支</strong></p><blockquote><p>在执行hexo deploy命令时，可能会提示找不到git, 解决方法：<br>在Hexo 3.0版本后deploy git 被分开的，所以需要安装，安装命令如下: <code>npm install hexo-deployer-git –save</code> ,安装好后再尝试一下就ok</p></blockquote><h3 id="绑定域名"><a href="#绑定域名" class="headerlink" title="绑定域名"></a>绑定域名</h3><p>如果对于github默认分配的二级域名example.github.io满意的话，就用这个也是可以的。如果不太满意，可以购买一个域名，博主是从阿里云购买的.cn 域名。</p><p>设置域名有两种方式: </p><ul><li>主域名绑定: 如example.com</li><li>子域名绑定：如blog.example.com</li></ul><h4 id="主域名绑定"><a href="#主域名绑定" class="headerlink" title="主域名绑定"></a>主域名绑定</h4><ul><li>在source根目录下新建文件 <font color="skyblue"> CNAME </font>，无后缀，纯文本文件，内容为要绑定的域名<br>example.com,如果要使用 <a href="http://www.example.com的形式，文件内容改为www.example.com" target="_blank" rel="noopener">www.example.com的形式，文件内容改为www.example.com</a></li><li>DNS设置<ul><li>主机记录@，类型A，记录值192.30.252.153</li><li>主机记录www，类型A，记录值192.30.252.153</li><li>参考 <a href="https://help.github.com/articles/tips-for-configuring-an-a-record-with-your-dns-provider" target="_blank" rel="noopener">https://help.github.com/articles/tips-for-configuring-an-a-record-with-your-dns-provider</a></li></ul></li></ul><h4 id="子域名绑定"><a href="#子域名绑定" class="headerlink" title="子域名绑定"></a>子域名绑定</h4><ul><li>比如使用域名example.com的子域名blog.example.com <font color="skyblue"> CNAME </font>文件内容为blog.example.com</li><li>DNS设置<ul><li>主机记录blog，类型CNAME，记录值example.github.io</li><li>参考<a href="https://help.github.com/articles/tips-for-configuring-a-cname-record-with-your-dns-provider" target="_blank" rel="noopener">https://help.github.com/articles/tips-for-configuring-a-cname-record-with-your-dns-provider</a></li></ul></li></ul><h3 id="更换主题"><a href="#更换主题" class="headerlink" title="更换主题"></a>更换主题</h3><p><a href="https://github.com/hexojs/hexo/wiki/Themes" target="_blank" rel="noopener">https://github.com/hexojs/hexo/wiki/Themes</a><br>可以从这上面挑选一个自己喜欢的主题, 比如我觉得next还不错，<br>进入github的项目地址后, 复制项目地址, 在themes目录下，执行命令<code>git clone <a href="https://github.com/iissnan/hexo-theme-next.git" target="_blank" rel="noopener">https://github.com/iissnan/hexo-theme-next.git</a><br></code></p><p>完成后会在theme目录下生成hexo-theme-next主题文件夹<br>打开 _config.yml 配置文件，找到 theme 选项<br>将默认的 theme: landscape 更换为 theme: hexo-theme-next<br>此时，启动服务器 hexo s 可查看效果，之后便可静态化然后部署到github上即可。</p><p><a href="http://theme-next.iissnan.com/这是next主题的说明，可参照此修改默认配置。" target="_blank" rel="noopener">http://theme-next.iissnan.com/这是next主题的说明，可参照此修改默认配置。</a><br>其他主题也可借鉴说明</p><h3 id="配置插件"><a href="#配置插件" class="headerlink" title="配置插件"></a>配置插件</h3><p>至于插件有很多，可以按照自己的喜好配置插件，下面只给出几个教程的连接，需要的同学自行配置就好。<br><a href="http://www.tuicool.com/articles/AfQnQjy" target="_blank" rel="noopener">http://www.tuicool.com/articles/AfQnQjy</a><br>还有一些插件是主题自带的，注意就好。</p><h3 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h3><p>到此, 博客就已经搭建完毕啦~<br>虽然搭建博客的过程中遇到很多问题，但是博客成功搭建之后，心里真是觉得很满足。<br>希望想搭建博客的同学能在这篇文章中得到帮助。</p>]]></content>
      
      <categories>
          
          <category> Web前端 </category>
          
          <category> Hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> web </tag>
            
        </tags>
      
    </entry>
    
  
  
</search>
